import{l as je,m as ce,n as be,r as h,o as Ce,p as we,q as Te,t as te,v as Z,w as ne,x as Se,y as Ne,z as ke,A as Be,b as L,j as e,d as K,B as de,D as oe,E as Ee,F as se,G as Q,P as Ie,H as Pe,I as Fe,J as Oe,K as Re,N as Ae,M as ae,O as De,Q as $e,T as Me,U as a,i as $,a as J,u as X,V as D,W as Le,S as B,X as ie,Y as H,Z as ze,_ as Ge,$ as Ke,a0 as re,a1 as _e,a2 as He,a3 as W,a4 as qe}from"./index-Bv9j-p6T.js";import{T as Ue,g as Ve,a as We,b as Qe,U as M,i as ue,c as A}from"./consts-DicWaN5o.js";import{g as q}from"./guardapolvos-B0G3ihqX.js";import{s as U}from"./token-By_1sbaR.js";import{M as I}from"./Modal-C2r8_MiI.js";import{A as Ze}from"./Alert-Ct5zrt0L.js";import{P as Je}from"./PaginationProductos-D6t2ZfI6.js";const Xe=()=>{};function Ye(t,o,{disabled:s,clickTrigger:u}={}){const r=o||Xe;je(t,r,{disabled:s,clickTrigger:u});const v=ce(y=>{be(y)&&r(y)});h.useEffect(()=>{if(s||t==null)return;const y=Ce(we(t));let n=(y.defaultView||window).event;const f=Te(y,"keyup",m=>{if(m===n){n=void 0;return}v(m)});return()=>{f()}},[t,s,v])}const me=h.forwardRef((t,o)=>{const{flip:s,offset:u,placement:r,containerPadding:v,popperConfig:y={},transition:n,runTransition:f}=t,[m,w]=te(),[b,T]=te(),g=Z(w,o),p=ne(t.container),c=ne(t.target),[i,l]=h.useState(!t.show),d=Se(c,m,Ne({placement:r,enableEvents:!!t.show,containerPadding:v||5,flip:s,offset:u,arrowElement:b,popperConfig:y}));t.show&&i&&l(!1);const x=(...j)=>{l(!0),t.onExited&&t.onExited(...j)},k=t.show||!i;if(Ye(m,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!k)return null;const{onExit:E,onExiting:N,onEnter:S,onEntering:C,onEntered:F}=t;let O=t.children(Object.assign({},d.attributes.popper,{style:d.styles.popper,ref:g}),{popper:d,placement:r,show:!!t.show,arrowProps:Object.assign({},d.attributes.arrow,{style:d.styles.arrow,ref:T})});return O=ke(n,f,{in:!!t.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:O,onExit:E,onExiting:N,onExited:x,onEnter:S,onEntering:C,onEntered:F}),p?Be.createPortal(O,p):null});me.displayName="Overlay";const he=h.forwardRef(({className:t,bsPrefix:o,as:s="div",...u},r)=>(o=L(o,"popover-header"),e.jsx(s,{ref:r,className:K(t,o),...u})));he.displayName="PopoverHeader";const Y=h.forwardRef(({className:t,bsPrefix:o,as:s="div",...u},r)=>(o=L(o,"popover-body"),e.jsx(s,{ref:r,className:K(t,o),...u})));Y.displayName="PopoverBody";function ge(t,o){let s=t;return t==="left"?s=o?"end":"start":t==="right"&&(s=o?"start":"end"),s}function xe(t="absolute"){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const et=h.forwardRef(({bsPrefix:t,placement:o="right",className:s,style:u,children:r,body:v,arrowProps:y,hasDoneInitialMeasure:n,popper:f,show:m,...w},b)=>{const T=L(t,"popover"),g=de(),[p]=(o==null?void 0:o.split("-"))||[],c=ge(p,g);let i=u;return m&&!n&&(i={...u,...xe(f==null?void 0:f.strategy)}),e.jsxs("div",{ref:b,role:"tooltip",style:i,"x-placement":p,className:K(s,T,p&&`bs-popover-${c}`),...w,children:[e.jsx("div",{className:"popover-arrow",...y}),v?e.jsx(Y,{children:r}):r]})}),tt=Object.assign(et,{Header:he,Body:Y,POPPER_OFFSET:[0,8]}),fe=h.forwardRef(({bsPrefix:t,placement:o="right",className:s,style:u,children:r,arrowProps:v,hasDoneInitialMeasure:y,popper:n,show:f,...m},w)=>{t=L(t,"tooltip");const b=de(),[T]=(o==null?void 0:o.split("-"))||[],g=ge(T,b);let p=u;return f&&!y&&(p={...u,...xe(n==null?void 0:n.strategy)}),e.jsxs("div",{ref:w,style:p,role:"tooltip","x-placement":T,className:K(s,t,`bs-tooltip-${g}`),...m,children:[e.jsx("div",{className:"tooltip-arrow",...v}),e.jsx("div",{className:`${t}-inner`,children:r})]})});fe.displayName="Tooltip";const ee=Object.assign(fe,{TOOLTIP_OFFSET:[0,6]});function nt(t){const o=h.useRef(null),s=L(void 0,"popover"),u=L(void 0,"tooltip"),r=h.useMemo(()=>({name:"offset",options:{offset:()=>{if(t)return t;if(o.current){if(oe(o.current,s))return tt.POPPER_OFFSET;if(oe(o.current,u))return ee.TOOLTIP_OFFSET}return[0,0]}}}),[t,s,u]);return[o,[r]]}function ot(t,o){const{ref:s}=t,{ref:u}=o;t.ref=s.__wrapped||(s.__wrapped=r=>s(Q(r))),o.ref=u.__wrapped||(u.__wrapped=r=>u(Q(r)))}const pe=h.forwardRef(({children:t,transition:o=se,popperConfig:s={},rootClose:u=!1,placement:r="top",show:v=!1,...y},n)=>{const f=h.useRef({}),[m,w]=h.useState(null),[b,T]=nt(y.offset),g=Z(n,b),p=o===!0?se:o||void 0,c=ce(i=>{w(i),s==null||s.onFirstUpdate==null||s.onFirstUpdate(i)});return Ee(()=>{m&&y.target&&(f.current.scheduleUpdate==null||f.current.scheduleUpdate())},[m,y.target]),h.useEffect(()=>{v||w(null)},[v]),e.jsx(me,{...y,ref:g,popperConfig:{...s,modifiers:T.concat(s.modifiers||[]),onFirstUpdate:c},transition:p,rootClose:u,placement:r,show:v,children:(i,{arrowProps:l,popper:d,show:x})=>{var k,E;ot(i,l);const N=d==null?void 0:d.placement,S=Object.assign(f.current,{state:d==null?void 0:d.state,scheduleUpdate:d==null?void 0:d.update,placement:N,outOfBoundaries:(d==null||(k=d.state)==null||(E=k.modifiersData.hide)==null?void 0:E.isReferenceHidden)||!1,strategy:s.strategy}),C=!!m;return typeof t=="function"?t({...i,placement:N,show:x,...!o&&x&&{className:"show"},popper:S,arrowProps:l,hasDoneInitialMeasure:C}):h.cloneElement(t,{...i,placement:N,arrowProps:l,popper:S,hasDoneInitialMeasure:C,className:K(t.props.className,!o&&x&&"show"),style:{...t.props.style,...i.style}})}})});pe.displayName="Overlay";function st(t){return t&&typeof t=="object"?t:{show:t,hide:t}}function le(t,o,s){const[u]=o,r=u.currentTarget,v=u.relatedTarget||u.nativeEvent[s];(!v||v!==r)&&!Oe(r,v)&&t(...o)}Ie.oneOf(["click","hover","focus"]);const ve=({trigger:t=["hover","focus"],overlay:o,children:s,popperConfig:u={},show:r,defaultShow:v=!1,onToggle:y,delay:n,placement:f,flip:m=f&&f.indexOf("auto")!==-1,...w})=>{const b=h.useRef(null),T=Z(b,s.ref),g=Pe(),p=h.useRef(""),[c,i]=Fe(r,v,y),l=st(n),{onFocus:d,onBlur:x,onClick:k}=typeof s!="function"?h.Children.only(s).props:{},E=P=>{T(Q(P))},N=h.useCallback(()=>{if(g.clear(),p.current="show",!l.show){i(!0);return}g.set(()=>{p.current==="show"&&i(!0)},l.show)},[l.show,i,g]),S=h.useCallback(()=>{if(g.clear(),p.current="hide",!l.hide){i(!1);return}g.set(()=>{p.current==="hide"&&i(!1)},l.hide)},[l.hide,i,g]),C=h.useCallback((...P)=>{N(),d==null||d(...P)},[N,d]),F=h.useCallback((...P)=>{S(),x==null||x(...P)},[S,x]),O=h.useCallback((...P)=>{i(!c),k==null||k(...P)},[k,i,c]),j=h.useCallback((...P)=>{le(N,P,"fromElement")},[N]),z=h.useCallback((...P)=>{le(S,P,"toElement")},[S]),V=t==null?[]:[].concat(t),R={ref:E};return V.indexOf("click")!==-1&&(R.onClick=O),V.indexOf("focus")!==-1&&(R.onFocus=C,R.onBlur=F),V.indexOf("hover")!==-1&&(R.onMouseOver=j,R.onMouseOut=z),e.jsxs(e.Fragment,{children:[typeof s=="function"?s(R):h.cloneElement(s,R),e.jsx(pe,{...w,show:c,onHide:S,flip:m,placement:f,popperConfig:u,target:b.current,children:o})]})};function at(t){let o;return De(t,s=>{o==null&&(o=s.props.eventKey)}),o}function it(t){const{title:o,eventKey:s,disabled:u,tabClassName:r,tabAttrs:v,id:y}=t.props;return o==null?null:e.jsx($e,{as:"li",role:"presentation",children:e.jsx(Me,{as:"button",type:"button",eventKey:s,disabled:u,id:y,className:r,...v,children:o})})}const _=t=>{const{id:o,onSelect:s,transition:u,mountOnEnter:r=!1,unmountOnExit:v=!1,variant:y="tabs",children:n,activeKey:f=at(n),...m}=Re(t,{activeKey:"onSelect"});return e.jsxs(Ue,{id:o,activeKey:f,onSelect:s,transition:Ve(u),mountOnEnter:r,unmountOnExit:v,children:[e.jsx(Ae,{id:o,...m,role:"tablist",as:"ul",variant:y,children:ae(n,it)}),e.jsx(We,{children:ae(n,w=>{const b={...w.props};return delete b.title,delete b.disabled,delete b.tabClassName,delete b.tabAttrs,e.jsx(Qe,{...b})})})]})};_.displayName="Tabs";const ye=({amount:t,size:o,formData:s,handleInputChange:u})=>{const r={display:"flex",justifyContent:"space-around",gap:"5px"},v={width:"50%"};return e.jsxs("div",{style:r,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(a.Label,{children:[e.jsxs("strong",{children:["Cantidad",t!==""?":":""," "]}),t]}),e.jsx(a.Control,{type:"text",name:"amount",placeholder:"nueva cantidad",value:s.amount,onChange:u})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(a.Label,{children:[e.jsxs("strong",{children:["Talle",t!==""?":":""," "]}),o]}),e.jsx(a.Control,{type:"text",name:"size",placeholder:"nuevo talle",value:s.size,onChange:u})]})]})},rt=t=>{const o=$(i=>i.login),s=J(),u=X(),r=$(i=>i.guardapolvos.filtred),[v,y]=h.useState([]),[n,f]=h.useState({id:"",name:"",price:"",type:"",category:"",discountPrice:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:"",featured:""});h.useEffect(()=>{f({...n,description:{...n.description,general:t.item.description?t.item.description.general:""}})},[t.item]);const m=i=>{const{name:l,value:d}=i.target;d.startsWith(" ")||f(l==="base"||l==="general"||l==="detalle"||l==="vivos"||l==="bolsillos"?{...n,description:{...n.description,[l]:d}}:{...n,[l]:d})},w=i=>{const l=i.target.files[0];if(!l)return;const d=i.target.name;d==="imageFront"?f(x=>({...x,img:l.name})):d==="imageBack"?f(x=>({...x,img2:l.name})):d==="imageSizes"&&f(x=>({...x,img3:l.name})),y(x=>[...x,l])},b=async i=>{i.preventDefault();const l=Date.now()+"-"+Math.round(Math.random()*1e9);let d="";if(/prueba[\$0-9]/.test(t.item.name)&&(d="-dev"),!Le(n.price)&&n.price!==""){B.fire({title:"Ingresa un precio valido!",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}const x={id:t.item.id,table:t.item.table,amountToBuy:1,img:n.img!==""?`${M}${d}/${l}-${n.img}`:t.item.img,img2:n.img2!==""?`${M}${d}/${l}-${n.img2}`:t.item.img2,img3:n.img3!==""?`${M}${d}/${l}-${n.img3}`:t.item.img3,name:n.name!==""?n.name:t.item.name,price:n.price!==""?Number(n.price):Number(t.item.price),discountPrice:n.discountPrice!==""?n.discountPrice:t.item.discountPrice,amount:n.amount!==""?n.amount:t.item.amount,size:n.size!==""?n.size:t.item.size,type:n.type!==""?n.type:t.item.type,category:n.category!==""?n.category:t.item.category,description:{general:n.description.general!==""?n.description.general:t.item.description.general,base:n.description.base!==""?n.description.base:t.item.description.base,detalle:n.description.detalle!==""?n.description.detalle:t.item.description.detalle,vivos:n.description.vivos!==""?n.description.vivos:t.item.description.vivos,bolsillos:n.description.bolsillos!==""?n.description.bolsillos:t.item.description.bolsillos}},k=new FormData;k.append("blobName",l),k.append("containerName","guardapolvos");try{B.fire({title:"Estas segura que queres modificar?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async E=>{if(E.isConfirmed){try{const N=U(o.token);await q.update(t.item.id,x,N);const S=r.map(C=>C.id===t.item.id?x:C);u(ie(x.table,S.filter(C=>C.table===x.table))),v.length>0&&(v.forEach(C=>k.append("images",C)),await ue.upload(k,N))}catch(N){if(console.log(N),N.response.status===401)B.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(S=>{if(S.isConfirmed){s("/login");return}});else{B.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}B.fire({title:`${t.item.name} modificado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{t.handleProductEdited(),t.onHide(),f({id:"",name:"",price:"",type:"",category:"",discountPrice:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:"",featured:""})})}})}catch(E){console.error("Error:",E),B.fire({title:"Error",text:"No se pudo modificar el producto",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},T=()=>{B.fire({title:"Estas segura que queres eliminar el guardapolvo?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async i=>{if(i.isConfirmed)try{const l=U(o.token);await q.deleteGuardapolvo(t.item.id,l);const d=r.filter(x=>x.id!==t.item.id);u(ie(t.item.table,d.filter(x=>x.table===t.item.table))),B.fire({title:"Guardapolvo eliminado correctamente!",icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(x=>{x.isConfirmed&&(t.onHide(),t.handleProductEdited())})}catch(l){console.error("Error:",l),B.fire({title:"Error",text:"No se pudo eliminar el guardapolvo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}),l.response.data.error==="token expired"&&s("/login")}})},g={display:"flex",justifyContent:"space-around",gap:"5px"},p={width:"50%"},c=i=>e.jsx(ee,{id:"button-tooltip",...i,children:"Una vez agregado un descuento, el precio actual se mantiene (aparece tachado), pero el precio que se muestra a los clientes es el del descuento. Para sacar el descuento aplicado, hay que darle un nuevo valor de 0"});return e.jsxs(I,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(I.Header,{closeButton:!0,children:e.jsxs(I.Title,{id:"contained-modal-title-vcenter",children:["Modificar ",t.item.name]})}),e.jsx(I.Body,{children:e.jsxs(a,{onSubmit:b,encType:"multipart/form-data",children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Nombre actual:"})," ",t.item.name]}),e.jsx(a.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:m})]}),e.jsxs("div",{style:g,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:{width:"50%"},children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Precio actual:"})," $ ",t.item.price]}),e.jsx(a.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:m})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",style:{width:"50%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Descuento actual:"})," $ ",t.item.discountPrice||t.item.discountPrice>0?t.item.discountPrice:"0"]}),e.jsx(ve,{placement:"right",delay:{show:250,hide:400},overlay:c,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]}),e.jsx(a.Control,{type:"text",name:"discountPrice",placeholder:"nuevo descuento",value:n.discountPrice,onChange:m})]})]}),t.item.table==="stock"?e.jsx(ye,{amount:t.item.amount,size:t.item.size,formData:n,handleInputChange:m}):null,t.item.category==="accesorios"&&e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Tipo"})}),e.jsxs(a.Select,{name:"type",value:n.type,onChange:m,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"totebag",children:"Tote Bag"})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Descripcion actual:"})}),t.item.category==="guardapolvo"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:g,children:[e.jsxs("div",{style:p,children:[e.jsx("strong",{children:"Base:"})," ",t.item.description!==void 0?t.item.description.base:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:m,value:n.description.base})]}),e.jsxs("div",{style:p,children:[e.jsx("strong",{children:"Detalle:"})," ",t.item.description!==void 0?t.item.description.detalle:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:m,value:n.description.detalle})]})]}),e.jsxs("div",{style:g,children:[e.jsxs("div",{style:p,children:[e.jsx("strong",{children:"Vivos:"})," ",t.item.description?t.item.description.vivos:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:m,value:n.description.vivos})]}),e.jsxs("div",{style:p,children:[e.jsx("strong",{children:"Bolsillos:"})," ",t.item.description?t.item.description.bolsillos:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:m,value:n.description.bolsillos})]})]})]}):null,e.jsx(a.Control,{as:"textarea",placeholder:"nueva descripcion",name:"general",onChange:m,value:n.description.general,rows:4})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(a.Control,{type:"file",name:"imageFront",onChange:w})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(a.Control,{type:"file",name:"imageBack",onChange:w})]}),t.item.table==="stock"?e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(a.Control,{type:"file",name:"imageSizes",onChange:w})]}):null]})}),e.jsxs(I.Footer,{children:[e.jsx(D,{variant:"danger",onClick:T,style:{marginRight:"auto"},children:"Eliminar"}),e.jsx(D,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(D,{variant:"dark",onClick:b,children:"Guardar Cambios"})]})]})},lt=t=>{const o=J(),s=$(T=>T.login),[u,r]=h.useState({display:"none",text:""}),[v,y]=h.useState([]),[n,f]=h.useState({name:"",price:"",type:"",category:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]}),m=T=>{const{name:g,value:p}=T.target;f(g==="base"||g==="general"||g==="detalle"||g==="vivos"||g==="bolsillos"?{...n,description:{...n.description,[g]:p}}:{...n,[g]:p})},w=T=>{const g=T.target.files[0];if(!g)return;const p=T.target.name;p==="imageFront"?f(c=>({...c,img:g.name})):p==="imageBack"?f(c=>({...c,img2:g.name})):p==="imageSizes"&&f(c=>({...c,img3:g.name})),y(c=>[...c,g]),f(c=>({...c,imgs:[...n.imgs,g.name]}))},b=async T=>{T.preventDefault();const g=Date.now()+"-"+Math.round(Math.random()*1e9);if(n.name===""){r({display:"block",text:"Ingresar nombre"});return}else if(n.price===""){r({display:"block",text:"Ingresar precio"});return}else if(n.description.general===""){r({display:"block",text:"Ingresar descripcion"});return}else if(n.img===""){r({display:"block",text:"Ingresar imagen frente"});return}else if(n.img2===""){r({display:"block",text:"Ingresar dorso"});return}if(t.table==="stock"){if(n.amount===""){r({display:"block",text:"Ingresar cantidad"});return}else if(n.size===""){r({display:"block",text:"Ingresar talle"});return}}r({display:"none",text:""});let p="";/prueba[\$0-9]/.test(n.name)&&(p="-dev");const c=n;c.img=`${M}${p}/${g}-${n.img}`,c.img2=`${M}${p}/${g}-${n.img2}`,c.img3=n.img3!==""?`${M}${p}/${g}-${n.img3}`:void 0,c.table=t.table,c.type=t.type,c.category=t.category,c.discountPrice=void 0;const i=new FormData;i.append("blobName",g),i.append("containerName","guardapolvos"),console.log(n);try{B.fire({title:`Estas segura que queres agregar ${n.name}?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async l=>{if(l.isConfirmed){try{const d=U(s.token);await q.create(n,d),v.forEach(x=>{i.append("images",x)}),await ue.upload(i,d)}catch(d){if(console.error(d),d.response.status===401)B.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(x=>{x.isConfirmed&&o("/login")});else{B.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}B.fire({title:`${n.name} agregado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{t.handleProductCreated(),t.onHide(),f({name:"",price:"",type:"",category:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]})})}})}catch(l){console.error("Error:",l)}};return e.jsxs(I,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(I.Header,{closeButton:!0,children:e.jsx(I.Title,{id:"contained-modal-title-vcenter",children:"Agregar nuevo producto"})}),e.jsx(Ze,{variant:"danger",style:{display:`${u.display}`},children:u.text},"danger"),e.jsx(I.Body,{children:e.jsxs(a,{onSubmit:b,encType:"multipart/form-data",children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Nombre"})}),e.jsx(a.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:m})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Precio"})}),e.jsx(a.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:m})]}),t.category==="accesorios"&&e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Tipo"})}),e.jsxs(a.Select,{name:"type",value:n.type,onChange:m,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"totebag",children:"Totebag"})]})]}),t.table==="stock"?e.jsx(ye,{amount:"",size:"",formData:n,handleInputChange:m}):null,e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Descripcion"})}),t.category!=="accesorios"?e.jsxs(e.Fragment,{children:[e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:m,value:n.description.base}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:m,value:n.description.detalle}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:m,value:n.description.vivos}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:m,value:n.description.bolsillos})]}):null,e.jsx(a.Control,{as:"textarea",placeholder:"nueva descripcion general",name:"general",onChange:m,value:n.description.general,rows:3})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(a.Control,{type:"file",name:"imageFront",onChange:w})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(a.Control,{type:"file",name:"imageBack",onChange:w})]}),t.table==="stock"?e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(a.Control,{type:"file",name:"imageSizes",onChange:w})]}):null]})}),e.jsxs(I.Footer,{children:[e.jsx(D,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(D,{variant:"dark",onClick:b,children:"Guardar Cambios"})]})]})},G=({title:t,table:o,type:s,category:u,showCreateModal:r,showEditModal:v,refreshKey:y})=>{var O;const[n,f]=h.useState(!1),[m,w]=h.useState([]);h.useEffect(()=>{b()},[s,y]);const b=async()=>{const j=await H.getSearch({type:s,category:u});w(j)},T=$(j=>j.filter.search.toLowerCase()),g=X(),[p,c]=h.useState(1),i=6,l=m.length,d=Math.ceil(l/i),x=j=>{c(j)},k=()=>{const j=(p-1)*i,z=j+i;if(m.length>0)return m.slice(j,z)},E=async()=>{if(f(!0),T!==""){c(1);const j=await H.getSearch({table:o,name:T,type:s,category:u});w(j)}else N();setTimeout(()=>{f(!1)},1e3)},N=()=>{g(_e("")),b()},S=j=>{B.fire({imageUrl:j,showConfirmButton:!1})},C={margin:"0px",fontSize:"16px",background:"inherit",border:"none"},F={marginRight:"5px",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",backgroundColor:"#f3f3f3",padding:"4px",borderRadius:"6px"};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex w-100",children:[e.jsx("h4",{className:"label-titulos",children:t}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex"},children:[e.jsx("div",{onClick:()=>N(),style:F,children:"reiniciar"}),e.jsx("div",{children:e.jsx(ze,{displaySearch:E,filtrateSearch:null})}),e.jsx("button",{onClick:()=>r(o),style:C,children:e.jsx(Ge,{width:"20",height:"20"})})]})]}),n?e.jsx(Ke,{}):e.jsxs("div",{className:"tabla-container",children:[e.jsxs("table",{className:"tabla-de-productoss",children:[e.jsx("thead",{children:o==="stock"?e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Talle"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{})]}):e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{children:"Editar"})]})}),(O=k())==null?void 0:O.map((j,z)=>e.jsx("tbody",{children:e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("td",{children:j.name}),e.jsxs("td",{children:["$ ",re(j)?j.discountPrice:j.price]}),o==="stock"?e.jsx("td",{children:j.amount}):"",o==="stock"?e.jsx("td",{children:j.size}):"",e.jsx("td",{children:e.jsx("img",{src:j.img,onClick:()=>S(j.img),alt:j.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:e.jsx("img",{src:j.img2,onClick:()=>S(j.img2),alt:j.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:re(j)?e.jsx("i",{className:"bi bi-check-lg",style:{color:"green"}}):e.jsx("i",{className:"bi bi-x-lg",style:{color:"red"}})}),e.jsx("td",{onClick:()=>v(j,o),style:{cursor:"pointer"},children:e.jsx("i",{className:"bi bi-pencil-square"})})]})},z))]}),e.jsx(Je,{currentPage:p,totalPages:d,onPageChange:x})]})]})},ct=({show:t,onHide:o})=>{const s=$(c=>c.login),u=J(),[r,v]=h.useState("guardapolvo"),[y,n]=h.useState(0),[f,m]=h.useState([]);h.useEffect(()=>{w("guardapolvo",r==="guardapolvo"?"":r)},[r]);const w=async(c,i)=>{let l=[];i===""?l=await H.getSearch({category:c}):l=await H.getSearch({type:i,category:c}),m(l)},b=c=>{v(c.target.value)},T=c=>{const i=c.target.value/100;n(i)},g=async(c,i)=>{try{const l=U(s.token);B.fire({title:`Estas segura que queres modificar en un ${c*100}% el precio de los guardapolvos?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async d=>{if(d.isConfirmed)try{if((await q.changePriceByPorcentage({porcent:c,guardapolvos:i},l)).ok){He(.4);return}else throw new Error("Error al intentar modificar el precio.")}catch(x){if(console.log(x),x.response.status===401)B.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(k=>{if(k.isConfirmed){u("/login");return}});else{B.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}})}catch(l){console.error(l),B.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},p=c=>e.jsx(ee,{id:"button-tooltip",...c,children:"Si queremos bajar el precio, lo unico que hay que hacer es poner el numero en negativo. Ejemplo: Queremos bajar un 10%, ponemos -10%."});return e.jsxs(I,{show:t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(I.Header,{closeButton:!0,children:e.jsx(I.Title,{id:"contained-modal-title-vcenter",children:"Administrar todos los productos"})}),e.jsxs(I.Body,{children:[e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"Cambiar el precio a: "}),e.jsxs("select",{name:"",onChange:b,style:{marginLeft:"5px",border:"none",cursor:"pointer",outline:"none",boxShadow:"none"},children:[e.jsx("option",{value:"guardapolvo",children:"Todos"}),e.jsx("option",{value:"nivel_inicial",children:"Nivel Inicial"}),e.jsx("option",{value:"primaria",children:"Primaria"}),e.jsx("option",{value:"stock",children:"Stock"}),e.jsx("option",{value:"niños",children:"Niños"})]})]}),e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"En un: "}),e.jsx("input",{type:"text",onChange:T,style:{width:"40px",outline:"none",boxShadow:"none",border:"1px solid #e2e2e2",marginLeft:"4px"}}),e.jsx("p",{style:{margin:"0px",marginRight:"20px"},children:"%"}),e.jsx(ve,{placement:"right",delay:{show:250,hide:400},overlay:p,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]})]}),e.jsxs(I.Footer,{children:[e.jsx(D,{variant:"secondary",onClick:o,children:"Cerrar"}),e.jsx(D,{className:"btn btn-dark",onClick:()=>g(y,f),children:"Aplicar cambios"})]})]})},pt=()=>{const t=$(C=>C.administration.categoryTabChoosen),o=$(C=>C.administration.typeTabChoosen),s=X(),[u,r]=h.useState(!1),[v,y]=h.useState(!1),[n,f]=h.useState(!1),[m,w]=h.useState(""),[b,T]=h.useState(""),[g,p]=h.useState({}),[c,i]=h.useState(0),l=()=>{i(C=>C+1)};h.useEffect(()=>{t==="accesorios"?s(W("totebag")):t==="guardapolvo"&&s(W("nivel_inicial"))},[t]);const d=(C,F)=>{y(!0),w(F),p(C)},x=(C,F)=>{w(C),T(F),r(!0)},k=()=>{f(!0)},E=C=>{s(W(C))},N=C=>{s(qe(C))},S={width:"100%"};return e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"contenedor-tablas-productos",children:[e.jsx("div",{className:"d-flex w-100 mb-5",onClick:()=>k(),children:e.jsxs("div",{className:"card",style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-body",children:"Administrar todos los productos"}),e.jsxs("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"small text-black stretched-link",children:"Ver detalles"}),e.jsx("div",{className:"small text-black",children:e.jsx("i",{className:"fas fa-angle-right"})})]})]})}),e.jsx("div",{style:{width:"100%",backgroundColor:"#fff",padding:"10px"},className:"tabs-container",children:e.jsxs(_,{defaultActiveKey:t,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:N,children:[e.jsx(A,{eventKey:"guardapolvo",title:"Guardapolvos",style:S,children:e.jsxs(_,{defaultActiveKey:o,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:E,children:[e.jsx(A,{eventKey:"nivel_inicial",title:"Nivel Inicial",style:S,children:e.jsx(G,{title:"NIVEL INICIAL",table:"nivel_inicial",category:"guardapolvo",type:"nivel_inicial",showCreateModal:()=>x("nivel_inicial","guardapolvo"),showEditModal:d,refreshKey:c})}),e.jsx(A,{eventKey:"primaria",title:"Primaria",style:S,children:e.jsx(G,{title:"PRIMARIA",table:"primaria",category:"guardapolvo",type:"primaria",showCreateModal:()=>x("primaria","guardapolvo"),showEditModal:d,refreshKey:c})}),e.jsx(A,{eventKey:"stock",title:"Stock",style:S,children:e.jsx(G,{title:"STOCK",table:"stock",category:"guardapolvo",type:"stock",showCreateModal:()=>x("stock","guardapolvo"),showEditModal:d,refreshKey:c})}),e.jsx(A,{eventKey:"niños",title:"Niños",style:S,children:e.jsx(G,{title:"NIÑOS",table:"stock",category:"guardapolvo",type:"niños",showCreateModal:()=>x("stock","guardapolvo"),showEditModal:d,refreshKey:c})})]})}),e.jsx(A,{eventKey:"accesorios",title:"Accesorios",style:S,children:e.jsx(_,{defaultActiveKey:o,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:E,children:e.jsx(A,{eventKey:"totebag",title:"Totebags",style:S,children:e.jsx(G,{title:"TOTEBAGS",table:"stock",category:"accesorios",type:"totebag",showCreateModal:()=>x("stock","accesorios"),showEditModal:d,refreshKey:c})})})})]})}),e.jsx(rt,{item:g,show:v,table:m,onHide:()=>y(!1),handleProductEdited:l}),e.jsx(lt,{show:u,table:m,type:o,category:b,onHide:()=>r(!1),handleProductCreated:l}),e.jsx(ct,{show:n,onHide:()=>f(!1)})]})})})};export{pt as default};
