import{j as e,F as n,S as y,g as A,c as D,d as B,b as G,r as C,B as w,e as R,N as U,m as P,f as _,h as V,i as Z,u as z,k as J,I as Q,l as W,n as X,o as Y,p as ee}from"./index-BayNPa4S.js";import{U as N,i as M,T as te,g as ne,a as ae,b as oe,c as $}from"./Tab-C7Pyip-E.js";import{s as E}from"./token-By_1sbaR.js";import{M as S}from"./Modal-CxFuC2CA.js";import{A as ie}from"./Alert-BMwFZoXD.js";import{P as re}from"./PaginationProductos-BmBpiiLB.js";const K=({amount:t,size:s,formData:h,handleInputChange:g})=>e.jsxs("div",{children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsxs("strong",{children:["Cantidad",t!==""?":":""," "]}),t]}),e.jsx(n.Control,{type:"text",name:"amount",placeholder:"nueva cantidad",value:h.amount,onChange:g})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsxs("strong",{children:["Talle",t!==""?":":""," "]}),s]}),e.jsx(n.Control,{type:"text",name:"size",placeholder:"nuevo talle",value:h.size,onChange:g})]})]}),se=(t,s)=>{y.fire({title:"Estas segura que queres eliminar el guardapolvo?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async h=>{if(h.isConfirmed)try{const g=E(s.token);await A.deleteGuardapolvo(t,g),y.fire({title:"Guardapolvo eliminado correctamente!",icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(x=>{x.isConfirmed&&D(.5)})}catch(g){console.error("Error:",g),y.fire({title:"Error",text:"No se pudo eliminar el guardapolvo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}),g.response.data.error==="token expired"&&navigate("/login")}})},le=t=>{const s=B(j=>j.login),h=G(),[g,x]=C.useState([]),[a,b]=C.useState({id:"",name:"",price:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:""});C.useEffect(()=>{b({...a,description:{...a.description,general:t.item.description?t.item.description.general:""}})},[t.item]);const o=j=>{const{name:r,value:l}=j.target;b(r==="base"||r==="general"||r==="detalle"||r==="vivos"||r==="bolsillos"?{...a,description:{...a.description,[r]:l}}:{...a,[r]:l})},v=j=>{const r=j.target.files[0];if(!r)return;const l=j.target.name;l==="imageFront"?b(i=>({...i,img:r.name})):l==="imageBack"?b(i=>({...i,img2:r.name})):l==="imageSizes"&&b(i=>({...i,img3:r.name})),x(i=>[...i,r])},p=async j=>{j.preventDefault();const r=Date.now()+"-"+Math.round(Math.random()*1e9);let l="";/prueba[\$0-9]/.test(t.item.name)&&(l="-dev");const i={img:a.img!==""?`${N}${l}/${r}-${a.img}`:t.item.img,img2:a.img2!==""?`${N}${l}/${r}-${a.img2}`:t.item.img2,img3:a.img3!==""?`${N}${l}/${r}-${a.img3}`:t.item.img3,name:a.name!==""?a.name:t.item.name,price:a.price!==""?a.price:t.item.price,amount:a.amount!==""?a.amount:t.item.amount,size:a.size!==""?a.size:t.item.size,description:{general:a.description.general!==""?a.description.general:t.item.description.general,base:a.description.base!==""?a.description.base:t.item.description.base,detalle:a.description.detalle!==""?a.description.detalle:t.item.description.detalle,vivos:a.description.vivos!==""?a.description.vivos:t.item.description.vivos,bolsillos:a.description.bolsillos!==""?a.description.bolsillos:t.item.description.bolsillos}},d=new FormData;d.append("blobName",r),d.append("containerName","guardapolvos");try{y.fire({title:"Estas segura que queres modificar?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async m=>{if(m.isConfirmed){try{const f=E(s.token);await A.update(t.item.id,i,f),g.forEach(c=>{d.append("images",c)}),await M.upload(d,f)}catch(f){if(f.response.status===401)y.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(c=>{if(c.isConfirmed){h("/login");return}});else{console.log(f),y.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}y.fire({title:`${t.item.name} modificado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{D(.5),t.onHide()})}})}catch(m){console.error("Error:",m),y.fire({title:"Error",text:"No se pudo modificar el producto",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}};return e.jsxs(S,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(S.Header,{closeButton:!0,children:e.jsxs(S.Title,{id:"contained-modal-title-vcenter",children:["Modificar ",t.item.name]})}),e.jsx(S.Body,{children:e.jsxs(n,{onSubmit:p,encType:"multipart/form-data",children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Nombre actual:"})," ",t.item.name]}),e.jsx(n.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:a.name,onChange:o})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Precio actual:"})," $ ",t.item.price]}),e.jsx(n.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:a.price,onChange:o})]}),t.table==="stock"?e.jsx(K,{amount:t.item.amount,size:t.item.size,formData:a,handleInputChange:o}):null,e.jsxs(n.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Descripcion actual:"}),"  "]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Base:"})," ",t.item.description!==void 0?t.item.description.base:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:o,value:a.description.base})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Detalle:"})," ",t.item.description!==void 0?t.item.description.detalle:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:o,value:a.description.detalle})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Vivos:"})," ",t.item.description?t.item.description.vivos:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:o,value:a.description.vivos})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Bolsillos:"})," ",t.item.description?t.item.description.bolsillos:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:o,value:a.description.bolsillos})]}),e.jsx(n.Control,{as:"textarea",placeholder:"nueva descripcion",name:"general",onChange:o,value:a.description.general,rows:4})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(n.Control,{type:"file",name:"imageFront",onChange:v})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(n.Control,{type:"file",name:"imageBack",onChange:v})]}),t.table==="stock"?e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(n.Control,{type:"file",name:"imageSizes",onChange:v})]}):null]})}),e.jsxs(S.Footer,{children:[e.jsx(w,{variant:"danger",onClick:()=>se(t.item.id,s),style:{marginRight:"auto"},children:"Eliminar guardapolvo"}),e.jsx(w,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(w,{variant:"dark",onClick:p,children:"Guardar Cambios"})]})]})},ce=t=>{const s=G(),h=B(l=>l.login),[g,x]=C.useState({display:"none",text:""}),[a,b]=C.useState([]),[o,v]=C.useState({name:"",price:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]}),p=l=>{const{name:i,value:d}=l.target;v(i==="base"||i==="general"||i==="detalle"||i==="vivos"||i==="bolsillos"?{...o,description:{...o.description,[i]:d}}:{...o,[i]:d})},j=l=>{const i=l.target.files[0];if(!i)return;const d=l.target.name;d==="imageFront"?v(m=>({...m,img:i.name})):d==="imageBack"?v(m=>({...m,img2:i.name})):d==="imageSizes"&&v(m=>({...m,img3:i.name})),b(m=>[...m,i]),v(m=>({...m,imgs:[...o.imgs,i.name]}))},r=async l=>{l.preventDefault();const i=Date.now()+"-"+Math.round(Math.random()*1e9);if(o.name===""){x({display:"block",text:"Ingresar nombre"});return}else if(o.price===""){x({display:"block",text:"Ingresar precio"});return}else if(o.description.general===""){x({display:"block",text:"Ingresar descripcion"});return}else if(o.img===""){x({display:"block",text:"Ingresar imagen frente"});return}else if(o.img2===""){x({display:"block",text:"Ingresar dorso"});return}if(t.table==="stock"){if(o.amount===""){x({display:"block",text:"Ingresar cantidad"});return}else if(o.size===""){x({display:"block",text:"Ingresar talle"});return}}x({display:"none",text:""});let d="";/prueba[\$0-9]/.test(o.name)&&(d="-dev");const m=o;m.img=`${N}${d}/${i}-${o.img}`,m.img2=`${N}${d}/${i}-${o.img2}`,m.img3=o.img3!==""?`${N}${d}/${i}-${o.img3}`:void 0,m.table=t.table;const f=new FormData;f.append("blobName",i),f.append("containerName","guardapolvos");try{y.fire({title:`Estas segura que queres agregar ${o.name}?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async c=>{if(c.isConfirmed){try{const I=E(h.token);await A.create(o,I),a.forEach(k=>{f.append("images",k)}),await M.upload(f,I)}catch(I){I.response.status===401&&y.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(k=>{k.isConfirmed&&s("/login")}),console.log(I);return}y.fire({title:`${o.name} agregado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{D(.5),t.onHide()})}})}catch(c){console.error("Error:",c)}};return e.jsxs(S,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(S.Header,{closeButton:!0,children:e.jsx(S.Title,{id:"contained-modal-title-vcenter",children:"Agregar nuevo guardapolvo"})}),e.jsx(ie,{variant:"danger",style:{display:`${g.display}`},children:g.text},"danger"),e.jsx(S.Body,{children:e.jsxs(n,{onSubmit:r,encType:"multipart/form-data",children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Nombre"})}),e.jsx(n.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:o.name,onChange:p})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Precio"})}),e.jsx(n.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:o.price,onChange:p})]}),t.table==="stock"?e.jsx(K,{amount:"",size:"",formData:o,handleInputChange:p}):null,e.jsxs(n.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Descripcion"})}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:p,value:o.description.base}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:p,value:o.description.detalle}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:p,value:o.description.vivos}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:p,value:o.description.bolsillos}),e.jsx(n.Control,{as:"textarea",placeholder:"nueva descripcion general",name:"general",onChange:p,value:o.description.general,rows:3})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(n.Control,{type:"file",name:"imageFront",onChange:j})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(n.Control,{type:"file",name:"imageBack",onChange:j})]}),t.table==="stock"?e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(n.Control,{type:"file",name:"imageSizes",onChange:j})]}):null]})}),e.jsxs(S.Footer,{children:[e.jsx(w,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(w,{variant:"dark",onClick:r,children:"Guardar Cambios"})]})]})};function de(t){let s;return _(t,h=>{s==null&&(s=h.props.eventKey)}),s}function me(t){const{title:s,eventKey:h,disabled:g,tabClassName:x,tabAttrs:a,id:b}=t.props;return s==null?null:e.jsx(V,{as:"li",role:"presentation",children:e.jsx(Z,{as:"button",type:"button",eventKey:h,disabled:g,id:b,className:x,...a,children:s})})}const q=t=>{const{id:s,onSelect:h,transition:g,mountOnEnter:x=!1,unmountOnExit:a=!1,variant:b="tabs",children:o,activeKey:v=de(o),...p}=R(t,{activeKey:"onSelect"});return e.jsxs(te,{id:s,activeKey:v,onSelect:h,transition:ne(g),mountOnEnter:x,unmountOnExit:a,children:[e.jsx(U,{id:s,...p,role:"tablist",as:"ul",variant:b,children:P(o,me)}),e.jsx(ae,{children:P(o,j=>{const r={...j.props};return delete r.title,delete r.disabled,delete r.tabClassName,delete r.tabAttrs,e.jsx(oe,{...r})})})]})};q.displayName="Tabs";const F=({title:t,table:s,guardapolvosList:h,showCreateModal:g,showEditModal:x})=>{const[a,b]=C.useState(!1),[o,v]=C.useState(h),p=B(u=>u.filter.search.toLowerCase()),j=z(),[r,l]=C.useState(1),i=6,d=o.length,m=Math.ceil(d/i),f=u=>{l(u)},c=()=>{const u=(r-1)*i,T=u+i;return o.slice(u,T)},I=()=>{if(b(!0),p!==""){l(1);const u=h.filter(T=>X(p,T));v(u)}else k();setTimeout(()=>{b(!1)},1e3)},k=()=>{j(Y("")),v(h)},L=u=>{y.fire({imageUrl:u,showConfirmButton:!1})},H={margin:"0px",fontSize:"16px",background:"inherit",border:"none"},O={marginRight:"5px",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",backgroundColor:"#f3f3f3",padding:"4px",borderRadius:"6px"};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex w-100",children:[e.jsx("h4",{className:"label-titulos",children:t}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex"},children:[o.length!==h.length?e.jsx("div",{onClick:()=>k(),style:O,children:"reiniciar"}):null,e.jsx("div",{children:e.jsx(J,{displaySearch:I,filtrateSearch:null})}),e.jsx("button",{onClick:()=>g(s),style:H,children:e.jsx(Q,{width:"20",height:"20"})})]})]}),a?e.jsx(W,{}):e.jsxs("div",{className:"tabla-container",children:[e.jsxs("table",{className:"tabla-de-productoss",children:[e.jsx("thead",{children:s==="stock"?e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Talle"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{children:"Editar"})]}):e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{children:"Editar"})]})}),c().map((u,T)=>e.jsx("tbody",{children:e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("td",{children:u.name}),e.jsxs("td",{children:["$ ",u.price]}),s==="stock"?e.jsx("td",{children:u.amount}):"",s==="stock"?e.jsx("td",{children:u.size}):"",e.jsx("td",{children:e.jsx("img",{src:u.img,onClick:()=>L(u.img),alt:u.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:e.jsx("img",{src:u.img2,onClick:()=>L(u.img2),alt:u.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{onClick:()=>x(u,s),style:{cursor:"pointer"},children:e.jsx("i",{className:"bi bi-pencil-square"})})]})},T))]}),e.jsx(re,{currentPage:r,totalPages:m,onPageChange:f})]})]})},be=()=>{const t=B(c=>c.guardapolvos.nivelInicial),s=B(c=>c.guardapolvos.primaria),h=B(c=>c.guardapolvos.stock),g=B(c=>c.administration.tabChoosen),x=z(),[a,b]=C.useState(!1),[o,v]=C.useState(!1),[p,j]=C.useState(""),[r,l]=C.useState({}),i=(c,I)=>{v(!0),j(I),l(c)},d=c=>{j(c),b(!0)},m=c=>{x(ee(c))},f={width:"100%"};return e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"contenedor-tablas-productos",children:[e.jsx("div",{style:{width:"100%",backgroundColor:"#fff",padding:"10px"},className:"tabs-container",children:e.jsxs(q,{defaultActiveKey:g,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:m,children:[e.jsx($,{eventKey:"nivel_inicial",title:"Nivel Inicial",style:f,children:e.jsx(F,{title:"NIVEL INICIAL",table:"nivel_inicial",guardapolvosList:t,showCreateModal:d,showEditModal:i})}),e.jsx($,{eventKey:"primaria",title:"Primaria",style:f,children:e.jsx(F,{title:"PRIMARIA",table:"primaria",guardapolvosList:s,showCreateModal:d,showEditModal:i})}),e.jsx($,{eventKey:"stock",title:"Stock",style:f,children:e.jsx(F,{title:"STOCK",table:"stock",guardapolvosList:h,showCreateModal:d,showEditModal:i})})]})}),e.jsx(le,{item:r,show:o,table:p,onHide:()=>v(!1)}),e.jsx(ce,{show:a,table:p,onHide:()=>b(!1)})]})})})};export{be as default};
