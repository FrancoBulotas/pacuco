import{j as e,k as A,q as D,a as B,b as G,r as C,u as z,i as R,o as U,t as _}from"./index-B7gCKMKK.js";import{U as N,i as M,T as V,g as Z,a as J,b as Q,c as $}from"./Tab-jw0JDmdm.js";import{s as E}from"./token-By_1sbaR.js";import{S as y}from"./sweetalert2.all-D3FCHpe_.js";import{F as n}from"./Form-dJ28kd3d.js";import{B as w}from"./Button-CozBTO4j.js";import{M as S}from"./Modal-DmH4B-LT.js";import{A as W}from"./Alert-B8h17yL2.js";import{u as X}from"./TransitionWrapper-5ppP3hMQ.js";import{a as Y,b as ee,N as te}from"./Nav-B3JvpTrg.js";import{m as P,f as ne}from"./ElementChildren-Du0aGwS8.js";import{S as oe,g as ae}from"./SearchBar-DxGOrjy2.js";import{P as ie}from"./PaginationProductos-DiT0BFGt.js";import{a as re}from"./icons-8_5Uv09s.js";import"./Fade-ByOLnFsp.js";import"./Anchor-3CuPqyzV.js";import"./SSRProvider-a4K4fnkK.js";import"./NoopTransition-DVFl9h6R.js";import"./useWillUnmount-DDVl-taq.js";import"./BootstrapModalManager-BLapAtUg.js";import"./useMounted-CA1dmZjP.js";import"./divWithClassName-C082gbAY.js";import"./DataKey-COGXBUcQ.js";const q=({amount:t,size:s,formData:h,handleInputChange:g})=>e.jsxs("div",{children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsxs("strong",{children:["Cantidad",t!==""?":":""," "]}),t]}),e.jsx(n.Control,{type:"text",name:"amount",placeholder:"nueva cantidad",value:h.amount,onChange:g})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsxs("strong",{children:["Talle",t!==""?":":""," "]}),s]}),e.jsx(n.Control,{type:"text",name:"size",placeholder:"nuevo talle",value:h.size,onChange:g})]})]}),se=(t,s)=>{y.fire({title:"Estas segura que queres eliminar el guardapolvo?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async h=>{if(h.isConfirmed)try{const g=E(s.token);await A.deleteGuardapolvo(t,g),y.fire({title:"Guardapolvo eliminado correctamente!",icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(x=>{x.isConfirmed&&D(.5)})}catch(g){console.error("Error:",g),y.fire({title:"Error",text:"No se pudo eliminar el guardapolvo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}),g.response.data.error==="token expired"&&navigate("/login")}})},le=t=>{const s=B(f=>f.login),h=G(),[g,x]=C.useState([]),[o,j]=C.useState({id:"",name:"",price:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:""});C.useEffect(()=>{j({...o,description:{...o.description,general:t.item.description?t.item.description.general:""}})},[t.item]);const a=f=>{const{name:r,value:l}=f.target;j(r==="base"||r==="general"||r==="detalle"||r==="vivos"||r==="bolsillos"?{...o,description:{...o.description,[r]:l}}:{...o,[r]:l})},b=f=>{const r=f.target.files[0];if(!r)return;const l=f.target.name;l==="imageFront"?j(i=>({...i,img:r.name})):l==="imageBack"?j(i=>({...i,img2:r.name})):l==="imageSizes"&&j(i=>({...i,img3:r.name})),x(i=>[...i,r])},p=async f=>{f.preventDefault();const r=Date.now()+"-"+Math.round(Math.random()*1e9);let l="";/prueba[\$0-9]/.test(t.item.name)&&(l="-dev");const i={img:o.img!==""?`${N}${l}/${r}-${o.img}`:t.item.img,img2:o.img2!==""?`${N}${l}/${r}-${o.img2}`:t.item.img2,img3:o.img3!==""?`${N}${l}/${r}-${o.img3}`:t.item.img3,name:o.name!==""?o.name:t.item.name,price:o.price!==""?o.price:t.item.price,amount:o.amount!==""?o.amount:t.item.amount,size:o.size!==""?o.size:t.item.size,description:{general:o.description.general!==""?o.description.general:t.item.description.general,base:o.description.base!==""?o.description.base:t.item.description.base,detalle:o.description.detalle!==""?o.description.detalle:t.item.description.detalle,vivos:o.description.vivos!==""?o.description.vivos:t.item.description.vivos,bolsillos:o.description.bolsillos!==""?o.description.bolsillos:t.item.description.bolsillos}},d=new FormData;d.append("blobName",r),d.append("containerName","guardapolvos");try{y.fire({title:"Estas segura que queres modificar?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async m=>{if(m.isConfirmed){try{const v=E(s.token);await A.update(t.item.id,i,v),g.forEach(c=>{d.append("images",c)}),await M.upload(d,v)}catch(v){if(v.response.status===401)y.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(c=>{if(c.isConfirmed){h("/login");return}});else{console.log(v),y.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}y.fire({title:`${t.item.name} modificado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{D(.5),t.onHide()})}})}catch(m){console.error("Error:",m),y.fire({title:"Error",text:"No se pudo modificar el producto",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}};return e.jsxs(S,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(S.Header,{closeButton:!0,children:e.jsxs(S.Title,{id:"contained-modal-title-vcenter",children:["Modificar ",t.item.name]})}),e.jsx(S.Body,{children:e.jsxs(n,{onSubmit:p,encType:"multipart/form-data",children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Nombre actual:"})," ",t.item.name]}),e.jsx(n.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:o.name,onChange:a})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Precio actual:"})," $ ",t.item.price]}),e.jsx(n.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:o.price,onChange:a})]}),t.table==="stock"?e.jsx(q,{amount:t.item.amount,size:t.item.size,formData:o,handleInputChange:a}):null,e.jsxs(n.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsxs(n.Label,{children:[e.jsx("strong",{children:"Descripcion actual:"}),"  "]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Base:"})," ",t.item.description!==void 0?t.item.description.base:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:a,value:o.description.base})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Detalle:"})," ",t.item.description!==void 0?t.item.description.detalle:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:a,value:o.description.detalle})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Vivos:"})," ",t.item.description?t.item.description.vivos:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:a,value:o.description.vivos})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Bolsillos:"})," ",t.item.description?t.item.description.bolsillos:null,e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:a,value:o.description.bolsillos})]}),e.jsx(n.Control,{as:"textarea",placeholder:"nueva descripcion",name:"general",onChange:a,value:o.description.general,rows:4})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(n.Control,{type:"file",name:"imageFront",onChange:b})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(n.Control,{type:"file",name:"imageBack",onChange:b})]}),t.table==="stock"?e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(n.Control,{type:"file",name:"imageSizes",onChange:b})]}):null]})}),e.jsxs(S.Footer,{children:[e.jsx(w,{variant:"danger",onClick:()=>se(t.item.id,s),style:{marginRight:"auto"},children:"Eliminar guardapolvo"}),e.jsx(w,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(w,{variant:"dark",onClick:p,children:"Guardar Cambios"})]})]})},ce=t=>{const s=G(),h=B(l=>l.login),[g,x]=C.useState({display:"none",text:""}),[o,j]=C.useState([]),[a,b]=C.useState({name:"",price:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]}),p=l=>{const{name:i,value:d}=l.target;b(i==="base"||i==="general"||i==="detalle"||i==="vivos"||i==="bolsillos"?{...a,description:{...a.description,[i]:d}}:{...a,[i]:d})},f=l=>{const i=l.target.files[0];if(!i)return;const d=l.target.name;d==="imageFront"?b(m=>({...m,img:i.name})):d==="imageBack"?b(m=>({...m,img2:i.name})):d==="imageSizes"&&b(m=>({...m,img3:i.name})),j(m=>[...m,i]),b(m=>({...m,imgs:[...a.imgs,i.name]}))},r=async l=>{l.preventDefault();const i=Date.now()+"-"+Math.round(Math.random()*1e9);if(a.name===""){x({display:"block",text:"Ingresar nombre"});return}else if(a.price===""){x({display:"block",text:"Ingresar precio"});return}else if(a.description.general===""){x({display:"block",text:"Ingresar descripcion"});return}else if(a.img===""){x({display:"block",text:"Ingresar imagen frente"});return}else if(a.img2===""){x({display:"block",text:"Ingresar dorso"});return}if(t.table==="stock"){if(a.amount===""){x({display:"block",text:"Ingresar cantidad"});return}else if(a.size===""){x({display:"block",text:"Ingresar talle"});return}}x({display:"none",text:""});let d="";/prueba[\$0-9]/.test(a.name)&&(d="-dev");const m=a;m.img=`${N}${d}/${i}-${a.img}`,m.img2=`${N}${d}/${i}-${a.img2}`,m.img3=a.img3!==""?`${N}${d}/${i}-${a.img3}`:void 0,m.table=t.table;const v=new FormData;v.append("blobName",i),v.append("containerName","guardapolvos");try{y.fire({title:`Estas segura que queres agregar ${a.name}?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async c=>{if(c.isConfirmed){try{const I=E(h.token);await A.create(a,I),o.forEach(k=>{v.append("images",k)}),await M.upload(v,I)}catch(I){I.response.status===401&&y.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(k=>{k.isConfirmed&&s("/login")}),console.log(I);return}y.fire({title:`${a.name} agregado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{D(.5),t.onHide()})}})}catch(c){console.error("Error:",c)}};return e.jsxs(S,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(S.Header,{closeButton:!0,children:e.jsx(S.Title,{id:"contained-modal-title-vcenter",children:"Agregar nuevo guardapolvo"})}),e.jsx(W,{variant:"danger",style:{display:`${g.display}`},children:g.text},"danger"),e.jsx(S.Body,{children:e.jsxs(n,{onSubmit:r,encType:"multipart/form-data",children:[e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Nombre"})}),e.jsx(n.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:a.name,onChange:p})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Precio"})}),e.jsx(n.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:a.price,onChange:p})]}),t.table==="stock"?e.jsx(q,{amount:"",size:"",formData:a,handleInputChange:p}):null,e.jsxs(n.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Descripcion"})}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:p,value:a.description.base}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:p,value:a.description.detalle}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:p,value:a.description.vivos}),e.jsx(n.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:p,value:a.description.bolsillos}),e.jsx(n.Control,{as:"textarea",placeholder:"nueva descripcion general",name:"general",onChange:p,value:a.description.general,rows:3})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(n.Control,{type:"file",name:"imageFront",onChange:f})]}),e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(n.Control,{type:"file",name:"imageBack",onChange:f})]}),t.table==="stock"?e.jsxs(n.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(n.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(n.Control,{type:"file",name:"imageSizes",onChange:f})]}):null]})}),e.jsxs(S.Footer,{children:[e.jsx(w,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(w,{variant:"dark",onClick:r,children:"Guardar Cambios"})]})]})};function de(t){let s;return ne(t,h=>{s==null&&(s=h.props.eventKey)}),s}function me(t){const{title:s,eventKey:h,disabled:g,tabClassName:x,tabAttrs:o,id:j}=t.props;return s==null?null:e.jsx(ee,{as:"li",role:"presentation",children:e.jsx(te,{as:"button",type:"button",eventKey:h,disabled:g,id:j,className:x,...o,children:s})})}const K=t=>{const{id:s,onSelect:h,transition:g,mountOnEnter:x=!1,unmountOnExit:o=!1,variant:j="tabs",children:a,activeKey:b=de(a),...p}=X(t,{activeKey:"onSelect"});return e.jsxs(V,{id:s,activeKey:b,onSelect:h,transition:Z(g),mountOnEnter:x,unmountOnExit:o,children:[e.jsx(Y,{id:s,...p,role:"tablist",as:"ul",variant:j,children:P(a,me)}),e.jsx(J,{children:P(a,f=>{const r={...f.props};return delete r.title,delete r.disabled,delete r.tabClassName,delete r.tabAttrs,e.jsx(Q,{...r})})})]})};K.displayName="Tabs";const F=({title:t,table:s,guardapolvosList:h,showCreateModal:g,showEditModal:x})=>{const[o,j]=C.useState(!1),[a,b]=C.useState(h),p=B(u=>u.filter.search.toLowerCase()),f=z(),[r,l]=C.useState(1),i=6,d=a.length,m=Math.ceil(d/i),v=u=>{l(u)},c=()=>{const u=(r-1)*i,T=u+i;return a.slice(u,T)},I=()=>{if(j(!0),p!==""){l(1);const u=h.filter(T=>ae(p,T));b(u)}else k();setTimeout(()=>{j(!1)},1e3)},k=()=>{f(U("")),b(h)},L=u=>{y.fire({imageUrl:u,showConfirmButton:!1})},H={margin:"0px",fontSize:"16px",background:"inherit",border:"none"},O={marginRight:"5px",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",backgroundColor:"#f3f3f3",padding:"4px",borderRadius:"6px"};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex w-100",children:[e.jsx("h4",{className:"label-titulos",children:t}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex"},children:[a.length!==h.length?e.jsx("div",{onClick:()=>k(),style:O,children:"reiniciar"}):null,e.jsx("div",{children:e.jsx(oe,{displaySearch:I,filtrateSearch:null})}),e.jsx("button",{onClick:()=>g(s),style:H,children:e.jsx(re,{width:"20",height:"20"})})]})]}),o?e.jsx(R,{}):e.jsxs("div",{className:"tabla-container",children:[e.jsxs("table",{className:"tabla-de-productoss",children:[e.jsx("thead",{children:s==="stock"?e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Talle"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{children:"Editar"})]}):e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{children:"Editar"})]})}),c().map((u,T)=>e.jsx("tbody",{children:e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("td",{children:u.name}),e.jsxs("td",{children:["$ ",u.price]}),s==="stock"?e.jsx("td",{children:u.amount}):"",s==="stock"?e.jsx("td",{children:u.size}):"",e.jsx("td",{children:e.jsx("img",{src:u.img,onClick:()=>L(u.img),alt:u.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:e.jsx("img",{src:u.img2,onClick:()=>L(u.img2),alt:u.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{onClick:()=>x(u,s),style:{cursor:"pointer"},children:e.jsx("i",{className:"bi bi-pencil-square"})})]})},T))]}),e.jsx(ie,{currentPage:r,totalPages:m,onPageChange:v})]})]})},Le=()=>{const t=B(c=>c.guardapolvos.nivelInicial),s=B(c=>c.guardapolvos.primaria),h=B(c=>c.guardapolvos.stock),g=B(c=>c.administration.tabChoosen),x=z(),[o,j]=C.useState(!1),[a,b]=C.useState(!1),[p,f]=C.useState(""),[r,l]=C.useState({}),i=(c,I)=>{b(!0),f(I),l(c)},d=c=>{f(c),j(!0)},m=c=>{x(_(c))},v={width:"100%"};return e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"contenedor-tablas-productos",children:[e.jsx("div",{style:{width:"100%",backgroundColor:"#fff",padding:"10px"},className:"tabs-container",children:e.jsxs(K,{defaultActiveKey:g,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:m,children:[e.jsx($,{eventKey:"nivel_inicial",title:"Nivel Inicial",style:v,children:e.jsx(F,{title:"NIVEL INICIAL",table:"nivel_inicial",guardapolvosList:t,showCreateModal:d,showEditModal:i})}),e.jsx($,{eventKey:"primaria",title:"Primaria",style:v,children:e.jsx(F,{title:"PRIMARIA",table:"primaria",guardapolvosList:s,showCreateModal:d,showEditModal:i})}),e.jsx($,{eventKey:"stock",title:"Stock",style:v,children:e.jsx(F,{title:"STOCK",table:"stock",guardapolvosList:h,showCreateModal:d,showEditModal:i})})]})}),e.jsx(le,{item:r,show:a,table:p,onHide:()=>b(!1)}),e.jsx(ce,{show:o,table:p,onHide:()=>j(!1)})]})})})};export{Le as default};
