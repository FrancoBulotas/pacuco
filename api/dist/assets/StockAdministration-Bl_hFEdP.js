import{l as ye,m as re,n as be,r as m,o as Ce,p as we,q as Se,t as Y,v as V,w as ee,x as ke,y as Ne,z as Te,A as Ie,b as $,j as e,d as G,B as le,D as te,E as Be,F as ne,G as K,P as Ee,H as Pe,I as Fe,J as Oe,K as Re,N as De,M as oe,O as Ae,Q as $e,T as Me,U as s,i as M,a as W,u as Q,V as R,W as Le,S as T,X as ae,Y as Z,Z as Ge,_ as ze,$ as _e,a0 as se,a1 as D,a2 as He,a3 as qe,a4 as Ue}from"./index-B8R_EK4O.js";import{T as Ke,g as Ve,a as We,b as Qe,U as A,i as ce,c as z}from"./consts-D8rsvAGA.js";import{g as H}from"./guardapolvos-DnljcMq2.js";import{s as q}from"./token-By_1sbaR.js";import{M as B}from"./Modal-DvvGoX08.js";import{A as Ze}from"./Alert-uLNCAVUP.js";import{P as Je}from"./PaginationProductos-CqIp8qsk.js";const Xe=()=>{};function Ye(t,a,{disabled:o,clickTrigger:d}={}){const i=a||Xe;ye(t,i,{disabled:o,clickTrigger:d});const v=re(y=>{be(y)&&i(y)});m.useEffect(()=>{if(o||t==null)return;const y=Ce(we(t));let n=(y.defaultView||window).event;const x=Se(y,"keyup",h=>{if(h===n){n=void 0;return}v(h)});return()=>{x()}},[t,o,v])}const de=m.forwardRef((t,a)=>{const{flip:o,offset:d,placement:i,containerPadding:v,popperConfig:y={},transition:n,runTransition:x}=t,[h,C]=Y(),[b,w]=Y(),u=V(C,a),j=ee(t.container),g=ee(t.target),[l,r]=m.useState(!t.show),c=ke(g,h,Ne({placement:i,enableEvents:!!t.show,containerPadding:v||5,flip:o,offset:d,arrowElement:b,popperConfig:y}));t.show&&l&&r(!1);const f=(...L)=>{r(!0),t.onExited&&t.onExited(...L)},N=t.show||!l;if(Ye(h,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!N)return null;const{onExit:I,onExiting:S,onEnter:k,onEntering:p,onEntered:P}=t;let F=t.children(Object.assign({},c.attributes.popper,{style:c.styles.popper,ref:u}),{popper:c,placement:i,show:!!t.show,arrowProps:Object.assign({},c.attributes.arrow,{style:c.styles.arrow,ref:w})});return F=Te(n,x,{in:!!t.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:F,onExit:I,onExiting:S,onExited:f,onEnter:k,onEntering:p,onEntered:P}),j?Ie.createPortal(F,j):null});de.displayName="Overlay";const ue=m.forwardRef(({className:t,bsPrefix:a,as:o="div",...d},i)=>(a=$(a,"popover-header"),e.jsx(o,{ref:i,className:G(t,a),...d})));ue.displayName="PopoverHeader";const J=m.forwardRef(({className:t,bsPrefix:a,as:o="div",...d},i)=>(a=$(a,"popover-body"),e.jsx(o,{ref:i,className:G(t,a),...d})));J.displayName="PopoverBody";function me(t,a){let o=t;return t==="left"?o=a?"end":"start":t==="right"&&(o=a?"start":"end"),o}function he(t="absolute"){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const et=m.forwardRef(({bsPrefix:t,placement:a="right",className:o,style:d,children:i,body:v,arrowProps:y,hasDoneInitialMeasure:n,popper:x,show:h,...C},b)=>{const w=$(t,"popover"),u=le(),[j]=(a==null?void 0:a.split("-"))||[],g=me(j,u);let l=d;return h&&!n&&(l={...d,...he(x==null?void 0:x.strategy)}),e.jsxs("div",{ref:b,role:"tooltip",style:l,"x-placement":j,className:G(o,w,j&&`bs-popover-${g}`),...C,children:[e.jsx("div",{className:"popover-arrow",...y}),v?e.jsx(J,{children:i}):i]})}),tt=Object.assign(et,{Header:ue,Body:J,POPPER_OFFSET:[0,8]}),ge=m.forwardRef(({bsPrefix:t,placement:a="right",className:o,style:d,children:i,arrowProps:v,hasDoneInitialMeasure:y,popper:n,show:x,...h},C)=>{t=$(t,"tooltip");const b=le(),[w]=(a==null?void 0:a.split("-"))||[],u=me(w,b);let j=d;return x&&!y&&(j={...d,...he(n==null?void 0:n.strategy)}),e.jsxs("div",{ref:C,style:j,role:"tooltip","x-placement":w,className:G(o,t,`bs-tooltip-${u}`),...h,children:[e.jsx("div",{className:"tooltip-arrow",...v}),e.jsx("div",{className:`${t}-inner`,children:i})]})});ge.displayName="Tooltip";const X=Object.assign(ge,{TOOLTIP_OFFSET:[0,6]});function nt(t){const a=m.useRef(null),o=$(void 0,"popover"),d=$(void 0,"tooltip"),i=m.useMemo(()=>({name:"offset",options:{offset:()=>{if(t)return t;if(a.current){if(te(a.current,o))return tt.POPPER_OFFSET;if(te(a.current,d))return X.TOOLTIP_OFFSET}return[0,0]}}}),[t,o,d]);return[a,[i]]}function ot(t,a){const{ref:o}=t,{ref:d}=a;t.ref=o.__wrapped||(o.__wrapped=i=>o(K(i))),a.ref=d.__wrapped||(d.__wrapped=i=>d(K(i)))}const xe=m.forwardRef(({children:t,transition:a=ne,popperConfig:o={},rootClose:d=!1,placement:i="top",show:v=!1,...y},n)=>{const x=m.useRef({}),[h,C]=m.useState(null),[b,w]=nt(y.offset),u=V(n,b),j=a===!0?ne:a||void 0,g=re(l=>{C(l),o==null||o.onFirstUpdate==null||o.onFirstUpdate(l)});return Be(()=>{h&&y.target&&(x.current.scheduleUpdate==null||x.current.scheduleUpdate())},[h,y.target]),m.useEffect(()=>{v||C(null)},[v]),e.jsx(de,{...y,ref:u,popperConfig:{...o,modifiers:w.concat(o.modifiers||[]),onFirstUpdate:g},transition:j,rootClose:d,placement:i,show:v,children:(l,{arrowProps:r,popper:c,show:f})=>{var N,I;ot(l,r);const S=c==null?void 0:c.placement,k=Object.assign(x.current,{state:c==null?void 0:c.state,scheduleUpdate:c==null?void 0:c.update,placement:S,outOfBoundaries:(c==null||(N=c.state)==null||(I=N.modifiersData.hide)==null?void 0:I.isReferenceHidden)||!1,strategy:o.strategy}),p=!!h;return typeof t=="function"?t({...l,placement:S,show:f,...!a&&f&&{className:"show"},popper:k,arrowProps:r,hasDoneInitialMeasure:p}):m.cloneElement(t,{...l,placement:S,arrowProps:r,popper:k,hasDoneInitialMeasure:p,className:G(t.props.className,!a&&f&&"show"),style:{...t.props.style,...l.style}})}})});xe.displayName="Overlay";function at(t){return t&&typeof t=="object"?t:{show:t,hide:t}}function ie(t,a,o){const[d]=a,i=d.currentTarget,v=d.relatedTarget||d.nativeEvent[o];(!v||v!==i)&&!Oe(i,v)&&t(...a)}Ee.oneOf(["click","hover","focus"]);const fe=({trigger:t=["hover","focus"],overlay:a,children:o,popperConfig:d={},show:i,defaultShow:v=!1,onToggle:y,delay:n,placement:x,flip:h=x&&x.indexOf("auto")!==-1,...C})=>{const b=m.useRef(null),w=V(b,o.ref),u=Pe(),j=m.useRef(""),[g,l]=Fe(i,v,y),r=at(n),{onFocus:c,onBlur:f,onClick:N}=typeof o!="function"?m.Children.only(o).props:{},I=E=>{w(K(E))},S=m.useCallback(()=>{if(u.clear(),j.current="show",!r.show){l(!0);return}u.set(()=>{j.current==="show"&&l(!0)},r.show)},[r.show,l,u]),k=m.useCallback(()=>{if(u.clear(),j.current="hide",!r.hide){l(!1);return}u.set(()=>{j.current==="hide"&&l(!1)},r.hide)},[r.hide,l,u]),p=m.useCallback((...E)=>{S(),c==null||c(...E)},[S,c]),P=m.useCallback((...E)=>{k(),f==null||f(...E)},[k,f]),F=m.useCallback((...E)=>{l(!g),N==null||N(...E)},[N,l,g]),L=m.useCallback((...E)=>{ie(S,E,"fromElement")},[S]),je=m.useCallback((...E)=>{ie(k,E,"toElement")},[k]),U=t==null?[]:[].concat(t),O={ref:I};return U.indexOf("click")!==-1&&(O.onClick=F),U.indexOf("focus")!==-1&&(O.onFocus=p,O.onBlur=P),U.indexOf("hover")!==-1&&(O.onMouseOver=L,O.onMouseOut=je),e.jsxs(e.Fragment,{children:[typeof o=="function"?o(O):m.cloneElement(o,O),e.jsx(xe,{...C,show:g,onHide:k,flip:h,placement:x,popperConfig:d,target:b.current,children:a})]})};function st(t){let a;return Ae(t,o=>{a==null&&(a=o.props.eventKey)}),a}function it(t){const{title:a,eventKey:o,disabled:d,tabClassName:i,tabAttrs:v,id:y}=t.props;return a==null?null:e.jsx($e,{as:"li",role:"presentation",children:e.jsx(Me,{as:"button",type:"button",eventKey:o,disabled:d,id:y,className:i,...v,children:a})})}const pe=t=>{const{id:a,onSelect:o,transition:d,mountOnEnter:i=!1,unmountOnExit:v=!1,variant:y="tabs",children:n,activeKey:x=st(n),...h}=Re(t,{activeKey:"onSelect"});return e.jsxs(Ke,{id:a,activeKey:x,onSelect:o,transition:Ve(d),mountOnEnter:i,unmountOnExit:v,children:[e.jsx(De,{id:a,...h,role:"tablist",as:"ul",variant:y,children:oe(n,it)}),e.jsx(We,{children:oe(n,C=>{const b={...C.props};return delete b.title,delete b.disabled,delete b.tabClassName,delete b.tabAttrs,e.jsx(Qe,{...b})})})]})};pe.displayName="Tabs";const ve=({amount:t,size:a,formData:o,handleInputChange:d})=>{const i={display:"flex",justifyContent:"space-around",gap:"5px"},v={width:"50%"};return e.jsxs("div",{style:i,children:[e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(s.Label,{children:[e.jsxs("strong",{children:["Cantidad",t!==""?":":""," "]}),t]}),e.jsx(s.Control,{type:"text",name:"amount",placeholder:"nueva cantidad",value:o.amount,onChange:d})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(s.Label,{children:[e.jsxs("strong",{children:["Talle",t!==""?":":""," "]}),a]}),e.jsx(s.Control,{type:"text",name:"size",placeholder:"nuevo talle",value:o.size,onChange:d})]})]})},rt=t=>{const a=M(l=>l.login),o=W(),d=Q(),i=M(l=>l.guardapolvos.filtred),[v,y]=m.useState([]),[n,x]=m.useState({id:"",name:"",price:"",type:"",category:"",discountPrice:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:"",featured:""});m.useEffect(()=>{x({...n,description:{...n.description,general:t.item.description?t.item.description.general:""}})},[t.item]);const h=l=>{const{name:r,value:c}=l.target;c.startsWith(" ")||x(r==="base"||r==="general"||r==="detalle"||r==="vivos"||r==="bolsillos"?{...n,description:{...n.description,[r]:c}}:{...n,[r]:c})},C=l=>{const r=l.target.files[0];if(!r)return;const c=l.target.name;c==="imageFront"?x(f=>({...f,img:r.name})):c==="imageBack"?x(f=>({...f,img2:r.name})):c==="imageSizes"&&x(f=>({...f,img3:r.name})),y(f=>[...f,r])},b=async l=>{l.preventDefault();const r=Date.now()+"-"+Math.round(Math.random()*1e9);let c="";if(/prueba[\$0-9]/.test(t.item.name)&&(c="-dev"),!Le(n.price)&&n.price!==""){T.fire({title:"Ingresa un precio valido!",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}const f={id:t.item.id,table:t.item.table,amountToBuy:1,img:n.img!==""?`${A}${c}/${r}-${n.img}`:t.item.img,img2:n.img2!==""?`${A}${c}/${r}-${n.img2}`:t.item.img2,img3:n.img3!==""?`${A}${c}/${r}-${n.img3}`:t.item.img3,name:n.name!==""?n.name:t.item.name,price:n.price!==""?Number(n.price):Number(t.item.price),discountPrice:n.discountPrice!==""?n.discountPrice:t.item.discountPrice,amount:n.amount!==""?n.amount:t.item.amount,size:n.size!==""?n.size:t.item.size,type:n.type!==""?n.type:t.item.type,category:n.category!==""?n.category:t.item.category,description:{general:n.description.general!==""?n.description.general:t.item.description.general,base:n.description.base!==""?n.description.base:t.item.description.base,detalle:n.description.detalle!==""?n.description.detalle:t.item.description.detalle,vivos:n.description.vivos!==""?n.description.vivos:t.item.description.vivos,bolsillos:n.description.bolsillos!==""?n.description.bolsillos:t.item.description.bolsillos}},N=new FormData;N.append("blobName",r),N.append("containerName","guardapolvos");try{T.fire({title:"Estas segura que queres modificar?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async I=>{if(I.isConfirmed){try{const S=q(a.token);await H.update(t.item.id,f,S);const k=i.map(p=>p.id===t.item.id?f:p);d(ae(f.table,k.filter(p=>p.table===f.table))),v.length>0&&(v.forEach(p=>N.append("images",p)),await ce.upload(N,S))}catch(S){if(console.log(S),S.response.status===401)T.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(k=>{if(k.isConfirmed){o("/login");return}});else{T.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}T.fire({title:`${t.item.name} modificado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{Z(.2),t.onHide()})}})}catch(I){console.error("Error:",I),T.fire({title:"Error",text:"No se pudo modificar el producto",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},w=()=>{T.fire({title:"Estas segura que queres eliminar el guardapolvo?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async l=>{if(l.isConfirmed)try{const r=q(a.token);await H.deleteGuardapolvo(t.item.id,r);const c=i.filter(f=>f.id!==t.item.id);d(ae(t.item.table,c.filter(f=>f.table===t.item.table))),T.fire({title:"Guardapolvo eliminado correctamente!",icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(f=>{f.isConfirmed&&t.onHide()})}catch(r){console.error("Error:",r),T.fire({title:"Error",text:"No se pudo eliminar el guardapolvo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}),r.response.data.error==="token expired"&&o("/login")}})},u={display:"flex",justifyContent:"space-around",gap:"5px"},j={width:"50%"},g=l=>e.jsx(X,{id:"button-tooltip",...l,children:"Una vez agregado un descuento, el precio actual se mantiene (aparece tachado), pero el precio que se muestra a los clientes es el del descuento. Para sacar el descuento aplicado, hay que darle un nuevo valor de 0"});return e.jsxs(B,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsxs(B.Title,{id:"contained-modal-title-vcenter",children:["Modificar ",t.item.name]})}),e.jsx(B.Body,{children:e.jsxs(s,{onSubmit:b,encType:"multipart/form-data",children:[e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsxs(s.Label,{children:[e.jsx("strong",{children:"Nombre actual:"})," ",t.item.name]}),e.jsx(s.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:h})]}),e.jsxs("div",{style:u,children:[e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput2",style:{width:"50%"},children:[e.jsxs(s.Label,{children:[e.jsx("strong",{children:"Precio actual:"})," $ ",t.item.price]}),e.jsx(s.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:h})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput3",style:{width:"50%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(s.Label,{children:[e.jsx("strong",{children:"Descuento actual:"})," $ ",t.item.discountPrice||t.item.discountPrice>0?t.item.discountPrice:"0"]}),e.jsx(fe,{placement:"right",delay:{show:250,hide:400},overlay:g,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]}),e.jsx(s.Control,{type:"text",name:"discountPrice",placeholder:"nuevo descuento",value:n.discountPrice,onChange:h})]})]}),t.item.table==="stock"?e.jsx(ve,{amount:t.item.amount,size:t.item.size,formData:n,handleInputChange:h}):null,t.item.category==="accesorios"&&e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Tipo"})}),e.jsxs(s.Select,{name:"type",value:n.type,onChange:h,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"totebag",children:"Tote Bag"})]})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Descripcion actual:"})}),t.item.category==="guardapolvo"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:u,children:[e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Base:"})," ",t.item.description!==void 0?t.item.description.base:null,e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:h,value:n.description.base})]}),e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Detalle:"})," ",t.item.description!==void 0?t.item.description.detalle:null,e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:h,value:n.description.detalle})]})]}),e.jsxs("div",{style:u,children:[e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Vivos:"})," ",t.item.description?t.item.description.vivos:null,e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:h,value:n.description.vivos})]}),e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Bolsillos:"})," ",t.item.description?t.item.description.bolsillos:null,e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:h,value:n.description.bolsillos})]})]})]}):null,e.jsx(s.Control,{as:"textarea",placeholder:"nueva descripcion",name:"general",onChange:h,value:n.description.general,rows:4})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(s.Control,{type:"file",name:"imageFront",onChange:C})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(s.Control,{type:"file",name:"imageBack",onChange:C})]}),t.item.table==="stock"?e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(s.Control,{type:"file",name:"imageSizes",onChange:C})]}):null]})}),e.jsxs(B.Footer,{children:[e.jsx(R,{variant:"danger",onClick:w,style:{marginRight:"auto"},children:"Eliminar"}),e.jsx(R,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(R,{variant:"dark",onClick:b,children:"Guardar Cambios"})]})]})},lt=t=>{const a=W(),o=M(w=>w.login),[d,i]=m.useState({display:"none",text:""}),[v,y]=m.useState([]),[n,x]=m.useState({name:"",price:"",type:"",category:t.category,description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]}),h=w=>{const{name:u,value:j}=w.target;x(u==="base"||u==="general"||u==="detalle"||u==="vivos"||u==="bolsillos"?{...n,description:{...n.description,[u]:j}}:{...n,[u]:j})},C=w=>{const u=w.target.files[0];if(!u)return;const j=w.target.name;j==="imageFront"?x(g=>({...g,img:u.name})):j==="imageBack"?x(g=>({...g,img2:u.name})):j==="imageSizes"&&x(g=>({...g,img3:u.name})),y(g=>[...g,u]),x(g=>({...g,imgs:[...n.imgs,u.name]}))},b=async w=>{w.preventDefault();const u=Date.now()+"-"+Math.round(Math.random()*1e9);if(n.name===""){i({display:"block",text:"Ingresar nombre"});return}else if(n.price===""){i({display:"block",text:"Ingresar precio"});return}else if(n.type===""){i({display:"block",text:"Ingresar tipo"});return}else if(n.description.general===""){i({display:"block",text:"Ingresar descripcion"});return}else if(n.img===""){i({display:"block",text:"Ingresar imagen frente"});return}else if(n.img2===""){i({display:"block",text:"Ingresar dorso"});return}if(t.table==="stock"){if(n.amount===""){i({display:"block",text:"Ingresar cantidad"});return}else if(n.size===""){i({display:"block",text:"Ingresar talle"});return}}i({display:"none",text:""});let j="";/prueba[\$0-9]/.test(n.name)&&(j="-dev");const g=n;g.img=`${A}${j}/${u}-${n.img}`,g.img2=`${A}${j}/${u}-${n.img2}`,g.img3=n.img3!==""?`${A}${j}/${u}-${n.img3}`:void 0,g.table=t.table,g.discountPrice=void 0;const l=new FormData;l.append("blobName",u),l.append("containerName","guardapolvos"),console.log(n);try{T.fire({title:`Estas segura que queres agregar ${n.name}?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async r=>{if(r.isConfirmed){try{const c=q(o.token);await H.create(n,c),v.forEach(f=>{l.append("images",f)}),await ce.upload(l,c)}catch(c){if(console.error(c),c.response.status===401)T.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(f=>{f.isConfirmed&&a("/login")});else{T.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}T.fire({title:`${n.name} agregado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{Z(.5),t.onHide()})}})}catch(r){console.error("Error:",r)}};return e.jsxs(B,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{id:"contained-modal-title-vcenter",children:"Agregar nuevo producto"})}),e.jsx(Ze,{variant:"danger",style:{display:`${d.display}`},children:d.text},"danger"),e.jsx(B.Body,{children:e.jsxs(s,{onSubmit:b,encType:"multipart/form-data",children:[e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Nombre"})}),e.jsx(s.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:h})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Precio"})}),e.jsx(s.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:h})]}),t.category==="accesorios"&&e.jsxs(s.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Tipo"})}),e.jsxs(s.Select,{name:"type",value:n.type,onChange:h,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"totebag",children:"Totebag"})]})]}),t.table==="stock"?e.jsx(ve,{amount:"",size:"",formData:n,handleInputChange:h}):null,e.jsxs(s.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Descripcion"})}),t.category!=="accesorios"?e.jsxs(e.Fragment,{children:[e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:h,value:n.description.base}),e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:h,value:n.description.detalle}),e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:h,value:n.description.vivos}),e.jsx(s.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:h,value:n.description.bolsillos})]}):null,e.jsx(s.Control,{as:"textarea",placeholder:"nueva descripcion general",name:"general",onChange:h,value:n.description.general,rows:3})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(s.Control,{type:"file",name:"imageFront",onChange:C})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(s.Control,{type:"file",name:"imageBack",onChange:C})]}),t.table==="stock"?e.jsxs(s.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(s.Control,{type:"file",name:"imageSizes",onChange:C})]}):null]})}),e.jsxs(B.Footer,{children:[e.jsx(R,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(R,{variant:"dark",onClick:b,children:"Guardar Cambios"})]})]})},_=({title:t,table:a,guardapolvosList:o,showCreateModal:d,showEditModal:i})=>{var k;const[v,y]=m.useState(!1),[n,x]=m.useState(o);m.useEffect(()=>{x(o)},[o]);const h=M(p=>p.filter.search.toLowerCase()),C=Q(),[b,w]=m.useState(1),u=6,j=n.length,g=Math.ceil(j/u),l=p=>{w(p)},r=()=>{const p=(b-1)*u,P=p+u;if(n.length>0)return n.slice(p,P)},c=async()=>{if(y(!0),h!==""){w(1);const p=await D.getSearch({table:a,name:h});x(p)}else f();setTimeout(()=>{y(!1)},1e3)},f=()=>{C(He("")),x(o)},N=p=>{T.fire({imageUrl:p,showConfirmButton:!1})},I={margin:"0px",fontSize:"16px",background:"inherit",border:"none"},S={marginRight:"5px",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",backgroundColor:"#f3f3f3",padding:"4px",borderRadius:"6px"};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex w-100",children:[e.jsx("h4",{className:"label-titulos",children:t}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex"},children:[n.length!==o.length?e.jsx("div",{onClick:()=>f(),style:S,children:"reiniciar"}):null,e.jsx("div",{children:e.jsx(Ge,{displaySearch:c,filtrateSearch:null})}),e.jsx("button",{onClick:()=>d(a),style:I,children:e.jsx(ze,{width:"20",height:"20"})})]})]}),v?e.jsx(_e,{}):e.jsxs("div",{className:"tabla-container",children:[e.jsxs("table",{className:"tabla-de-productoss",children:[e.jsx("thead",{children:a==="stock"?e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Talle"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{})]}):e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{children:"Editar"})]})}),(k=r())==null?void 0:k.map((p,P)=>e.jsx("tbody",{children:e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("td",{children:p.name}),e.jsxs("td",{children:["$ ",se(p)?p.discountPrice:p.price]}),a==="stock"?e.jsx("td",{children:p.amount}):"",a==="stock"?e.jsx("td",{children:p.size}):"",e.jsx("td",{children:e.jsx("img",{src:p.img,onClick:()=>N(p.img),alt:p.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:e.jsx("img",{src:p.img2,onClick:()=>N(p.img2),alt:p.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:se(p)?e.jsx("i",{className:"bi bi-check-lg",style:{color:"green"}}):e.jsx("i",{className:"bi bi-x-lg",style:{color:"red"}})}),e.jsx("td",{onClick:()=>i(p,a),style:{cursor:"pointer"},children:e.jsx("i",{className:"bi bi-pencil-square"})})]})},P))]}),e.jsx(Je,{currentPage:b,totalPages:g,onPageChange:l})]})]})},ct=({show:t,onHide:a,guardapolvosList:o})=>{const d=M(g=>g.login),i=W(),[v,y]=m.useState("guardapolvos"),[n,x]=m.useState(0),[h,C]=m.useState(o);m.useEffect(()=>{v==="nivel_inicial"&&C(o.nivelInicial),v==="primaria"&&C(o.primaria),v==="stock"&&C(o.stock),v==="guardapolvos"&&C(o.all)},[v,o]);const b=g=>{y(g.target.value)},w=g=>{const l=g.target.value/100;x(l)},u=async(g,l)=>{try{const r=q(d.token);T.fire({title:`Estas segura que queres modificar en un ${g*100}% el precio de los guardapolvos?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async c=>{if(c.isConfirmed)try{if((await H.changePriceByPorcentage({porcent:g,guardapolvos:l},r)).ok){Z(.4);return}else throw new Error("Error al intentar modificar el precio.")}catch(f){if(console.log(f),f.response.status===401)T.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(N=>{if(N.isConfirmed){i("/login");return}});else{T.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}})}catch(r){console.error(r),T.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},j=g=>e.jsx(X,{id:"button-tooltip",...g,children:"Si queremos bajar el precio, lo unico que hay que hacer es poner el numero en negativo. Ejemplo: Queremos bajar un 10%, ponemos -10%."});return e.jsxs(B,{show:t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{id:"contained-modal-title-vcenter",children:"Administrar todos los productos"})}),e.jsxs(B.Body,{children:[e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"Cambiar el precio a: "}),e.jsxs("select",{name:"",onChange:b,style:{marginLeft:"5px",border:"none",cursor:"pointer",outline:"none",boxShadow:"none"},children:[e.jsx("option",{value:"guardapolvos",children:"Todos"}),e.jsx("option",{value:"nivel_inicial",children:"Nivel Inicial"}),e.jsx("option",{value:"primaria",children:"Primaria"}),e.jsx("option",{value:"stock",children:"Stock"})]})]}),e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"En un: "}),e.jsx("input",{type:"text",onChange:w,style:{width:"40px",outline:"none",boxShadow:"none",border:"1px solid #e2e2e2",marginLeft:"4px"}}),e.jsx("p",{style:{margin:"0px",marginRight:"20px"},children:"%"}),e.jsx(fe,{placement:"right",delay:{show:250,hide:400},overlay:j,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]})]}),e.jsxs(B.Footer,{children:[e.jsx(R,{variant:"secondary",onClick:a,children:"Cerrar"}),e.jsx(R,{className:"btn btn-dark",onClick:()=>u(n,h),children:"Aplicar cambios"})]})]})},pt=()=>{const[t,a]=m.useState({all:[],nivelInicial:[],primaria:[],stock:[],accesorios:[]}),[o]=qe(),d=M(S=>S.administration.tabChoosen),i=Q(),[v,y]=m.useState(!1),[n,x]=m.useState(!1),[h,C]=m.useState(!1),[b,w]=m.useState(""),[u,j]=m.useState(""),[g,l]=m.useState({});m.useEffect(()=>{(async()=>{if(o&&o.size==0)try{const k=await D.getSearch({category:"guardapolvo"}),p=await D.getSearch({type:"nivel_inicial",category:"guardapolvo"}),P=await D.getSearch({type:"primaria",category:"guardapolvo"}),F=await D.getSearch({type:"stock",category:"guardapolvo"}),L=await D.getSearch({category:"accesorios"});a({all:k,nivelInicial:p,primaria:P,stock:F,accesorios:L})}catch(k){console.error(k.message)}})()},[o]);const r=(S,k)=>{x(!0),w(k),l(S)},c=(S,k)=>{w(S),j(k),y(!0)},f=()=>{C(!0)},N=S=>{i(Ue(S))},I={width:"100%"};return console.log(u,b),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"contenedor-tablas-productos",children:[e.jsx("div",{className:"d-flex w-100 mb-5",onClick:()=>f(),children:e.jsxs("div",{className:"card",style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-body",children:"Administrar todos los productos"}),e.jsxs("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"small text-black stretched-link",children:"Ver detalles"}),e.jsx("div",{className:"small text-black",children:e.jsx("i",{className:"fas fa-angle-right"})})]})]})}),e.jsx("div",{style:{width:"100%",backgroundColor:"#fff",padding:"10px"},className:"tabs-container",children:e.jsxs(pe,{defaultActiveKey:d,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:N,children:[e.jsx(z,{eventKey:"nivel_inicial",title:"Nivel Inicial",style:I,children:e.jsx(_,{title:"NIVEL INICIAL",table:"nivel_inicial",category:"guardapolvo",guardapolvosList:t.nivelInicial,showCreateModal:()=>c("nivel_inicial","guardapolvo"),showEditModal:r})}),e.jsx(z,{eventKey:"primaria",title:"Primaria",style:I,children:e.jsx(_,{title:"PRIMARIA",table:"primaria",category:"guardapolvo",guardapolvosList:t.primaria,showCreateModal:()=>c("primaria","guardapolvo"),showEditModal:r})}),e.jsx(z,{eventKey:"stock",title:"Stock",style:I,children:e.jsx(_,{title:"STOCK",table:"stock",category:"guardapolvo",guardapolvosList:t.stock,showCreateModal:()=>c("stock","guardapolvo"),showEditModal:r})}),e.jsx(z,{eventKey:"accesorios",title:"Accesorios",style:I,children:e.jsx(_,{title:"ACCESORIOS",table:"stock",category:"accesorios",guardapolvosList:t.accesorios,showCreateModal:()=>c("stock","accesorios"),showEditModal:r})})]})}),e.jsx(rt,{item:g,show:n,table:b,onHide:()=>x(!1)}),e.jsx(lt,{show:v,table:b,category:u,onHide:()=>y(!1)}),e.jsx(ct,{show:h,onHide:()=>C(!1),guardapolvosList:t})]})})})};export{pt as default};
