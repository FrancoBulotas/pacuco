import{l as be,m as re,n as ye,r as u,o as Ce,p as we,q as Se,t as Y,v as V,w as ee,x as Ne,y as Te,z as ke,A as Ie,b as A,j as e,d as G,B as le,D as te,E as Be,F as ne,G as K,P as Ee,H as Pe,I as Fe,J as Oe,K as Re,N as De,M as oe,O as Ae,Q as $e,T as Me,U as a,i as $,a as W,u as Q,V as O,W as Ge,S as I,X as se,Y as Z,Z as Le,_ as ze,$ as _e,a0 as ae,a1 as R,a2 as He,a3 as qe,a4 as Ue}from"./index-BhdDdMNN.js";import{T as Ke,g as Ve,a as We,b as Qe,U as D,i as ce,c as L}from"./consts-CgJsN4Ve.js";import{g as _}from"./guardapolvos-Db033S2f.js";import{s as H}from"./token-By_1sbaR.js";import{M as B}from"./Modal-DH2b4s_j.js";import{A as Ze}from"./Alert-CUABNgg2.js";import{P as Je}from"./PaginationProductos-BNfuREvU.js";const Xe=()=>{};function Ye(t,s,{disabled:o,clickTrigger:c}={}){const r=s||Xe;be(t,r,{disabled:o,clickTrigger:c});const v=re(b=>{ye(b)&&r(b)});u.useEffect(()=>{if(o||t==null)return;const b=Ce(we(t));let n=(b.defaultView||window).event;const f=Se(b,"keyup",m=>{if(m===n){n=void 0;return}v(m)});return()=>{f()}},[t,o,v])}const de=u.forwardRef((t,s)=>{const{flip:o,offset:c,placement:r,containerPadding:v,popperConfig:b={},transition:n,runTransition:f}=t,[m,y]=Y(),[C,w]=Y(),d=V(y,s),j=ee(t.container),h=ee(t.target),[i,l]=u.useState(!t.show),x=Ne(h,m,Te({placement:r,enableEvents:!!t.show,containerPadding:v||5,flip:o,offset:c,arrowElement:C,popperConfig:b}));t.show&&i&&l(!1);const g=(...q)=>{l(!0),t.onExited&&t.onExited(...q)},S=t.show||!i;if(Ye(m,t.onHide,{disabled:!t.rootClose||t.rootCloseDisabled,clickTrigger:t.rootCloseEvent}),!S)return null;const{onExit:k,onExiting:N,onEnter:T,onEntering:p,onEntered:P}=t;let M=t.children(Object.assign({},x.attributes.popper,{style:x.styles.popper,ref:d}),{popper:x,placement:r,show:!!t.show,arrowProps:Object.assign({},x.attributes.arrow,{style:x.styles.arrow,ref:w})});return M=ke(n,f,{in:!!t.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:M,onExit:k,onExiting:N,onExited:g,onEnter:T,onEntering:p,onEntered:P}),j?Ie.createPortal(M,j):null});de.displayName="Overlay";const ue=u.forwardRef(({className:t,bsPrefix:s,as:o="div",...c},r)=>(s=A(s,"popover-header"),e.jsx(o,{ref:r,className:G(t,s),...c})));ue.displayName="PopoverHeader";const J=u.forwardRef(({className:t,bsPrefix:s,as:o="div",...c},r)=>(s=A(s,"popover-body"),e.jsx(o,{ref:r,className:G(t,s),...c})));J.displayName="PopoverBody";function me(t,s){let o=t;return t==="left"?o=s?"end":"start":t==="right"&&(o=s?"start":"end"),o}function he(t="absolute"){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const et=u.forwardRef(({bsPrefix:t,placement:s="right",className:o,style:c,children:r,body:v,arrowProps:b,hasDoneInitialMeasure:n,popper:f,show:m,...y},C)=>{const w=A(t,"popover"),d=le(),[j]=(s==null?void 0:s.split("-"))||[],h=me(j,d);let i=c;return m&&!n&&(i={...c,...he(f==null?void 0:f.strategy)}),e.jsxs("div",{ref:C,role:"tooltip",style:i,"x-placement":j,className:G(o,w,j&&`bs-popover-${h}`),...y,children:[e.jsx("div",{className:"popover-arrow",...b}),v?e.jsx(J,{children:r}):r]})}),tt=Object.assign(et,{Header:ue,Body:J,POPPER_OFFSET:[0,8]}),xe=u.forwardRef(({bsPrefix:t,placement:s="right",className:o,style:c,children:r,arrowProps:v,hasDoneInitialMeasure:b,popper:n,show:f,...m},y)=>{t=A(t,"tooltip");const C=le(),[w]=(s==null?void 0:s.split("-"))||[],d=me(w,C);let j=c;return f&&!b&&(j={...c,...he(n==null?void 0:n.strategy)}),e.jsxs("div",{ref:y,style:j,role:"tooltip","x-placement":w,className:G(o,t,`bs-tooltip-${d}`),...m,children:[e.jsx("div",{className:"tooltip-arrow",...v}),e.jsx("div",{className:`${t}-inner`,children:r})]})});xe.displayName="Tooltip";const X=Object.assign(xe,{TOOLTIP_OFFSET:[0,6]});function nt(t){const s=u.useRef(null),o=A(void 0,"popover"),c=A(void 0,"tooltip"),r=u.useMemo(()=>({name:"offset",options:{offset:()=>{if(t)return t;if(s.current){if(te(s.current,o))return tt.POPPER_OFFSET;if(te(s.current,c))return X.TOOLTIP_OFFSET}return[0,0]}}}),[t,o,c]);return[s,[r]]}function ot(t,s){const{ref:o}=t,{ref:c}=s;t.ref=o.__wrapped||(o.__wrapped=r=>o(K(r))),s.ref=c.__wrapped||(c.__wrapped=r=>c(K(r)))}const ge=u.forwardRef(({children:t,transition:s=ne,popperConfig:o={},rootClose:c=!1,placement:r="top",show:v=!1,...b},n)=>{const f=u.useRef({}),[m,y]=u.useState(null),[C,w]=nt(b.offset),d=V(n,C),j=s===!0?ne:s||void 0,h=re(i=>{y(i),o==null||o.onFirstUpdate==null||o.onFirstUpdate(i)});return Be(()=>{m&&b.target&&(f.current.scheduleUpdate==null||f.current.scheduleUpdate())},[m,b.target]),u.useEffect(()=>{v||y(null)},[v]),e.jsx(de,{...b,ref:d,popperConfig:{...o,modifiers:w.concat(o.modifiers||[]),onFirstUpdate:h},transition:j,rootClose:c,placement:r,show:v,children:(i,{arrowProps:l,popper:x,show:g})=>{var S,k;ot(i,l);const N=x==null?void 0:x.placement,T=Object.assign(f.current,{state:x==null?void 0:x.state,scheduleUpdate:x==null?void 0:x.update,placement:N,outOfBoundaries:(x==null||(S=x.state)==null||(k=S.modifiersData.hide)==null?void 0:k.isReferenceHidden)||!1,strategy:o.strategy}),p=!!m;return typeof t=="function"?t({...i,placement:N,show:g,...!s&&g&&{className:"show"},popper:T,arrowProps:l,hasDoneInitialMeasure:p}):u.cloneElement(t,{...i,placement:N,arrowProps:l,popper:T,hasDoneInitialMeasure:p,className:G(t.props.className,!s&&g&&"show"),style:{...t.props.style,...i.style}})}})});ge.displayName="Overlay";function st(t){return t&&typeof t=="object"?t:{show:t,hide:t}}function ie(t,s,o){const[c]=s,r=c.currentTarget,v=c.relatedTarget||c.nativeEvent[o];(!v||v!==r)&&!Oe(r,v)&&t(...s)}Ee.oneOf(["click","hover","focus"]);const fe=({trigger:t=["hover","focus"],overlay:s,children:o,popperConfig:c={},show:r,defaultShow:v=!1,onToggle:b,delay:n,placement:f,flip:m=f&&f.indexOf("auto")!==-1,...y})=>{const C=u.useRef(null),w=V(C,o.ref),d=Pe(),j=u.useRef(""),[h,i]=Fe(r,v,b),l=st(n),{onFocus:x,onBlur:g,onClick:S}=typeof o!="function"?u.Children.only(o).props:{},k=E=>{w(K(E))},N=u.useCallback(()=>{if(d.clear(),j.current="show",!l.show){i(!0);return}d.set(()=>{j.current==="show"&&i(!0)},l.show)},[l.show,i,d]),T=u.useCallback(()=>{if(d.clear(),j.current="hide",!l.hide){i(!1);return}d.set(()=>{j.current==="hide"&&i(!1)},l.hide)},[l.hide,i,d]),p=u.useCallback((...E)=>{N(),x==null||x(...E)},[N,x]),P=u.useCallback((...E)=>{T(),g==null||g(...E)},[T,g]),M=u.useCallback((...E)=>{i(!h),S==null||S(...E)},[S,i,h]),q=u.useCallback((...E)=>{ie(N,E,"fromElement")},[N]),je=u.useCallback((...E)=>{ie(T,E,"toElement")},[T]),U=t==null?[]:[].concat(t),F={ref:k};return U.indexOf("click")!==-1&&(F.onClick=M),U.indexOf("focus")!==-1&&(F.onFocus=p,F.onBlur=P),U.indexOf("hover")!==-1&&(F.onMouseOver=q,F.onMouseOut=je),e.jsxs(e.Fragment,{children:[typeof o=="function"?o(F):u.cloneElement(o,F),e.jsx(ge,{...y,show:h,onHide:T,flip:m,placement:f,popperConfig:c,target:C.current,children:s})]})};function at(t){let s;return Ae(t,o=>{s==null&&(s=o.props.eventKey)}),s}function it(t){const{title:s,eventKey:o,disabled:c,tabClassName:r,tabAttrs:v,id:b}=t.props;return s==null?null:e.jsx($e,{as:"li",role:"presentation",children:e.jsx(Me,{as:"button",type:"button",eventKey:o,disabled:c,id:b,className:r,...v,children:s})})}const pe=t=>{const{id:s,onSelect:o,transition:c,mountOnEnter:r=!1,unmountOnExit:v=!1,variant:b="tabs",children:n,activeKey:f=at(n),...m}=Re(t,{activeKey:"onSelect"});return e.jsxs(Ke,{id:s,activeKey:f,onSelect:o,transition:Ve(c),mountOnEnter:r,unmountOnExit:v,children:[e.jsx(De,{id:s,...m,role:"tablist",as:"ul",variant:b,children:oe(n,it)}),e.jsx(We,{children:oe(n,y=>{const C={...y.props};return delete C.title,delete C.disabled,delete C.tabClassName,delete C.tabAttrs,e.jsx(Qe,{...C})})})]})};pe.displayName="Tabs";const ve=({amount:t,size:s,formData:o,handleInputChange:c})=>{const r={display:"flex",justifyContent:"space-around",gap:"5px"},v={width:"50%"};return e.jsxs("div",{style:r,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(a.Label,{children:[e.jsxs("strong",{children:["Cantidad",t!==""?":":""," "]}),t]}),e.jsx(a.Control,{type:"text",name:"amount",placeholder:"nueva cantidad",value:o.amount,onChange:c})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:v,children:[e.jsxs(a.Label,{children:[e.jsxs("strong",{children:["Talle",t!==""?":":""," "]}),s]}),e.jsx(a.Control,{type:"text",name:"size",placeholder:"nuevo talle",value:o.size,onChange:c})]})]})},rt=t=>{const s=$(i=>i.login),o=W(),c=Q(),r=$(i=>i.guardapolvos.filtred),[v,b]=u.useState([]),[n,f]=u.useState({id:"",name:"",price:"",type:"",discountPrice:"",amount:"",size:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},img:"",img2:"",img3:"",featured:""});u.useEffect(()=>{f({...n,description:{...n.description,general:t.item.description?t.item.description.general:""}})},[t.item]);const m=i=>{const{name:l,value:x}=i.target;x.startsWith(" ")||f(l==="base"||l==="general"||l==="detalle"||l==="vivos"||l==="bolsillos"?{...n,description:{...n.description,[l]:x}}:{...n,[l]:x})},y=i=>{const l=i.target.files[0];if(!l)return;const x=i.target.name;x==="imageFront"?f(g=>({...g,img:l.name})):x==="imageBack"?f(g=>({...g,img2:l.name})):x==="imageSizes"&&f(g=>({...g,img3:l.name})),b(g=>[...g,l])},C=async i=>{i.preventDefault();const l=Date.now()+"-"+Math.round(Math.random()*1e9);let x="";if(/prueba[\$0-9]/.test(t.item.name)&&(x="-dev"),!Ge(n.price)&&n.price!==""){I.fire({title:"Ingresa un precio valido!",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}const g={id:t.item.id,table:t.item.table,amountToBuy:1,img:n.img!==""?`${D}${x}/${l}-${n.img}`:t.item.img,img2:n.img2!==""?`${D}${x}/${l}-${n.img2}`:t.item.img2,img3:n.img3!==""?`${D}${x}/${l}-${n.img3}`:t.item.img3,name:n.name!==""?n.name:t.item.name,price:n.price!==""?Number(n.price):Number(t.item.price),discountPrice:n.discountPrice!==""?n.discountPrice:t.item.discountPrice,amount:n.amount!==""?n.amount:t.item.amount,size:n.size!==""?n.size:t.item.size,type:n.type!==""?n.type:t.item.type,description:{general:n.description.general!==""?n.description.general:t.item.description.general,base:n.description.base!==""?n.description.base:t.item.description.base,detalle:n.description.detalle!==""?n.description.detalle:t.item.description.detalle,vivos:n.description.vivos!==""?n.description.vivos:t.item.description.vivos,bolsillos:n.description.bolsillos!==""?n.description.bolsillos:t.item.description.bolsillos}},S=new FormData;S.append("blobName",l),S.append("containerName","guardapolvos");try{I.fire({title:"Estas segura que queres modificar?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async k=>{if(k.isConfirmed){try{const N=H(s.token);await _.update(t.item.id,g,N);const T=r.map(p=>p.id===t.item.id?g:p);c(se(g.table,T.filter(p=>p.table===g.table))),v.length>0&&(v.forEach(p=>S.append("images",p)),await ce.upload(S,N))}catch(N){if(console.log(N),N.response.status===401)I.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(T=>{if(T.isConfirmed){o("/login");return}});else{I.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}I.fire({title:`${t.item.name} modificado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{Z(.2),t.onHide()})}})}catch(k){console.error("Error:",k),I.fire({title:"Error",text:"No se pudo modificar el producto",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},w=()=>{I.fire({title:"Estas segura que queres eliminar el guardapolvo?",icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async i=>{if(i.isConfirmed)try{const l=H(s.token);await _.deleteGuardapolvo(t.item.id,l);const x=r.filter(g=>g.id!==t.item.id);c(se(t.item.table,x.filter(g=>g.table===t.item.table))),I.fire({title:"Guardapolvo eliminado correctamente!",icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(g=>{g.isConfirmed&&t.onHide()})}catch(l){console.error("Error:",l),I.fire({title:"Error",text:"No se pudo eliminar el guardapolvo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}),l.response.data.error==="token expired"&&o("/login")}})},d={display:"flex",justifyContent:"space-around",gap:"5px"},j={width:"50%"},h=i=>e.jsx(X,{id:"button-tooltip",...i,children:"Una vez agregado un descuento, el precio actual se mantiene (aparece tachado), pero el precio que se muestra a los clientes es el del descuento. Para sacar el descuento aplicado, hay que darle un nuevo valor de 0"});return e.jsxs(B,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsxs(B.Title,{id:"contained-modal-title-vcenter",children:["Modificar ",t.item.name]})}),e.jsx(B.Body,{children:e.jsxs(a,{onSubmit:C,encType:"multipart/form-data",children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Nombre actual:"})," ",t.item.name]}),e.jsx(a.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:m})]}),e.jsxs("div",{style:d,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",style:{width:"50%"},children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Precio actual:"})," $ ",t.item.price]}),e.jsx(a.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:m})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",style:{width:"50%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(a.Label,{children:[e.jsx("strong",{children:"Descuento actual:"})," $ ",t.item.discountPrice||t.item.discountPrice>0?t.item.discountPrice:"0"]}),e.jsx(fe,{placement:"right",delay:{show:250,hide:400},overlay:h,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]}),e.jsx(a.Control,{type:"text",name:"discountPrice",placeholder:"nuevo descuento",value:n.discountPrice,onChange:m})]})]}),t.table==="stock"||t.table==="accesorios"?e.jsx(ve,{amount:t.item.amount,size:t.item.size,formData:n,handleInputChange:m}):null,e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Categoria"})}),e.jsxs(a.Select,{name:"type",value:n.type,onChange:m,children:[e.jsx("option",{value:"",children:"Selecciona una categoría"}),e.jsx("option",{value:"guardapolvo",children:"Guardapolvo"}),e.jsx("option",{value:"totebag",children:"Tote Bag"})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Descripcion actual:"})}),t.table!=="accesorios"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:d,children:[e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Base:"})," ",t.item.description!==void 0?t.item.description.base:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:m,value:n.description.base})]}),e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Detalle:"})," ",t.item.description!==void 0?t.item.description.detalle:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:m,value:n.description.detalle})]})]}),e.jsxs("div",{style:d,children:[e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Vivos:"})," ",t.item.description?t.item.description.vivos:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:m,value:n.description.vivos})]}),e.jsxs("div",{style:j,children:[e.jsx("strong",{children:"Bolsillos:"})," ",t.item.description?t.item.description.bolsillos:null,e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:m,value:n.description.bolsillos})]})]})]}):null,e.jsx(a.Control,{as:"textarea",placeholder:"nueva descripcion",name:"general",onChange:m,value:n.description.general,rows:4})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(a.Control,{type:"file",name:"imageFront",onChange:y})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(a.Control,{type:"file",name:"imageBack",onChange:y})]}),t.table==="stock"?e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(a.Control,{type:"file",name:"imageSizes",onChange:y})]}):null]})}),e.jsxs(B.Footer,{children:[e.jsx(O,{variant:"danger",onClick:w,style:{marginRight:"auto"},children:"Eliminar"}),e.jsx(O,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(O,{variant:"dark",onClick:C,children:"Guardar Cambios"})]})]})},lt=t=>{const s=W(),o=$(w=>w.login),[c,r]=u.useState({display:"none",text:""}),[v,b]=u.useState([]),[n,f]=u.useState({name:"",price:"",type:"",description:{general:"",base:"",detalle:"",vivos:"",bolsillos:""},amount:"",amountToBuy:1,size:"",table:t.table,img:"",img2:"",img3:"",imgs:[]}),m=w=>{const{name:d,value:j}=w.target;f(d==="base"||d==="general"||d==="detalle"||d==="vivos"||d==="bolsillos"?{...n,description:{...n.description,[d]:j}}:{...n,[d]:j})},y=w=>{const d=w.target.files[0];if(!d)return;const j=w.target.name;j==="imageFront"?f(h=>({...h,img:d.name})):j==="imageBack"?f(h=>({...h,img2:d.name})):j==="imageSizes"&&f(h=>({...h,img3:d.name})),b(h=>[...h,d]),f(h=>({...h,imgs:[...n.imgs,d.name]}))},C=async w=>{w.preventDefault();const d=Date.now()+"-"+Math.round(Math.random()*1e9);if(n.name===""){r({display:"block",text:"Ingresar nombre"});return}else if(n.price===""){r({display:"block",text:"Ingresar precio"});return}else if(n.type===""){r({display:"block",text:"Ingresar categoria"});return}else if(n.description.general===""){r({display:"block",text:"Ingresar descripcion"});return}else if(n.img===""){r({display:"block",text:"Ingresar imagen frente"});return}else if(n.img2===""){r({display:"block",text:"Ingresar dorso"});return}if(t.table==="stock"){if(n.amount===""){r({display:"block",text:"Ingresar cantidad"});return}else if(n.size===""){r({display:"block",text:"Ingresar talle"});return}}r({display:"none",text:""});let j="";/prueba[\$0-9]/.test(n.name)&&(j="-dev");const h=n;h.img=`${D}${j}/${d}-${n.img}`,h.img2=`${D}${j}/${d}-${n.img2}`,h.img3=n.img3!==""?`${D}${j}/${d}-${n.img3}`:void 0,h.table=t.table,h.discountPrice=void 0;const i=new FormData;i.append("blobName",d),i.append("containerName","guardapolvos"),console.log(n);try{I.fire({title:`Estas segura que queres agregar ${n.name}?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async l=>{if(l.isConfirmed){try{const x=H(o.token);await _.create(n,x),v.forEach(g=>{i.append("images",g)}),await ce.upload(i,x)}catch(x){if(console.error(x),x.response.status===401)I.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(g=>{g.isConfirmed&&s("/login")});else{I.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}I.fire({title:`${n.name} agregado!`,icon:"success",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(()=>{Z(.5),t.onHide()})}})}catch(l){console.error("Error:",l)}};return e.jsxs(B,{...t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{id:"contained-modal-title-vcenter",children:"Agregar nuevo producto"})}),e.jsx(Ze,{variant:"danger",style:{display:`${c.display}`},children:c.text},"danger"),e.jsx(B.Body,{children:e.jsxs(a,{onSubmit:C,encType:"multipart/form-data",children:[e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Nombre"})}),e.jsx(a.Control,{type:"text",name:"name",placeholder:"nuevo nombre",value:n.name,onChange:m})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput2",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Precio"})}),e.jsx(a.Control,{type:"text",name:"price",placeholder:"nuevo precio",value:n.price,onChange:m})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"controlInput3",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Categoria"})}),e.jsxs(a.Select,{name:"type",value:n.type,onChange:m,children:[e.jsx("option",{value:"",children:"Selecciona una categoría"}),e.jsx("option",{value:"guardapolvo",children:"Guardapolvo"}),e.jsx("option",{value:"totebag",children:"Totebag"})]})]}),t.table==="stock"||t.table==="accesorios"?e.jsx(ve,{amount:"",size:"",formData:n,handleInputChange:m}):null,e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Descripcion"})}),t.table!=="accesorios"?e.jsxs(e.Fragment,{children:[e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nueva base",name:"base",onChange:m,value:n.description.base}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo detalle",name:"detalle",onChange:m,value:n.description.detalle}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo vivo",name:"vivos",onChange:m,value:n.description.vivos}),e.jsx(a.Control,{style:{marginBottom:"5px"},type:"text",placeholder:"nuevo bolsillos",name:"bolsillos",onChange:m,value:n.description.bolsillos})]}):null,e.jsx(a.Control,{as:"textarea",placeholder:"nueva descripcion general",name:"general",onChange:m,value:n.description.general,rows:3})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Frente"})}),e.jsx(a.Control,{type:"file",name:"imageFront",onChange:y})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Dorso"})}),e.jsx(a.Control,{type:"file",name:"imageBack",onChange:y})]}),t.table==="stock"?e.jsxs(a.Group,{className:"mb-3",controlId:"formFile",children:[e.jsx(a.Label,{children:e.jsx("strong",{children:"Imagen Talles"})}),e.jsx(a.Control,{type:"file",name:"imageSizes",onChange:y})]}):null]})}),e.jsxs(B.Footer,{children:[e.jsx(O,{variant:"secondary",onClick:t.onHide,children:"Cerrar"}),e.jsx(O,{variant:"dark",onClick:C,children:"Guardar Cambios"})]})]})},z=({title:t,table:s,guardapolvosList:o,showCreateModal:c,showEditModal:r})=>{var T;const[v,b]=u.useState(!1),[n,f]=u.useState(o);u.useEffect(()=>{f(o)},[o]);const m=$(p=>p.filter.search.toLowerCase()),y=Q(),[C,w]=u.useState(1),d=6,j=n.length,h=Math.ceil(j/d),i=p=>{w(p)},l=()=>{const p=(C-1)*d,P=p+d;if(n.length>0)return n.slice(p,P)},x=async()=>{if(b(!0),m!==""){w(1);const p=await R.getSearch({table:s,name:m});f(p)}else g();setTimeout(()=>{b(!1)},1e3)},g=()=>{y(He("")),f(o)},S=p=>{I.fire({imageUrl:p,showConfirmButton:!1})},k={margin:"0px",fontSize:"16px",background:"inherit",border:"none"},N={marginRight:"5px",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center",backgroundColor:"#f3f3f3",padding:"4px",borderRadius:"6px"};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex w-100",children:[e.jsx("h4",{className:"label-titulos",children:t}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex"},children:[n.length!==o.length?e.jsx("div",{onClick:()=>g(),style:N,children:"reiniciar"}):null,e.jsx("div",{children:e.jsx(Le,{displaySearch:x,filtrateSearch:null})}),e.jsx("button",{onClick:()=>c(s),style:k,children:e.jsx(ze,{width:"20",height:"20"})})]})]}),v?e.jsx(_e,{}):e.jsxs("div",{className:"tabla-container",children:[e.jsxs("table",{className:"tabla-de-productoss",children:[e.jsx("thead",{children:s==="stock"?e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Talle"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{})]}):e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Frente"}),e.jsx("th",{children:"Dorso"}),e.jsx("th",{style:{width:"50px"},children:"Descuento"}),e.jsx("th",{children:"Editar"})]})}),(T=l())==null?void 0:T.map((p,P)=>e.jsx("tbody",{children:e.jsxs("tr",{className:"tr-tabla-productos",children:[e.jsx("td",{children:p.name}),e.jsxs("td",{children:["$ ",ae(p)?p.discountPrice:p.price]}),s==="stock"?e.jsx("td",{children:p.amount}):"",s==="stock"?e.jsx("td",{children:p.size}):"",e.jsx("td",{children:e.jsx("img",{src:p.img,onClick:()=>S(p.img),alt:p.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:e.jsx("img",{src:p.img2,onClick:()=>S(p.img2),alt:p.description.general,className:"small-img-admin",style:{cursor:"pointer"}})}),e.jsx("td",{children:ae(p)?e.jsx("i",{className:"bi bi-check-lg",style:{color:"green"}}):e.jsx("i",{className:"bi bi-x-lg",style:{color:"red"}})}),e.jsx("td",{onClick:()=>r(p,s),style:{cursor:"pointer"},children:e.jsx("i",{className:"bi bi-pencil-square"})})]})},P))]}),e.jsx(Je,{currentPage:C,totalPages:h,onPageChange:i})]})]})},ct=({show:t,onHide:s,guardapolvosList:o})=>{const c=$(h=>h.login),r=W(),[v,b]=u.useState("guardapolvos"),[n,f]=u.useState(0),[m,y]=u.useState(o);u.useEffect(()=>{v==="nivel_inicial"&&y(o.nivelInicial),v==="primaria"&&y(o.primaria),v==="stock"&&y(o.stock),v==="guardapolvos"&&y(o.all)},[v,o]);const C=h=>{b(h.target.value)},w=h=>{const i=h.target.value/100;f(i)},d=async(h,i)=>{try{const l=H(c.token);I.fire({title:`Estas segura que queres modificar en un ${h*100}% el precio de los guardapolvos?`,icon:"question",confirmButtonText:"Aceptar",confirmButtonColor:"#000",showDenyButton:!0,denyButtonText:"Cancelar"}).then(async x=>{if(x.isConfirmed)try{if((await _.changePriceByPorcentage({porcent:h,guardapolvos:i},l)).ok){Z(.4);return}else throw new Error("Error al intentar modificar el precio.")}catch(g){if(console.log(g),g.response.status===401)I.fire({title:"Se cerro tu sesion!",text:"Deberas iniciar sesion nuevamente",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"}).then(S=>{if(S.isConfirmed){r("/login");return}});else{I.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"});return}}})}catch(l){console.error(l),I.fire({title:"Error inesperado",text:"Intentalo nuevamente mas tarde.",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000"})}},j=h=>e.jsx(X,{id:"button-tooltip",...h,children:"Si queremos bajar el precio, lo unico que hay que hacer es poner el numero en negativo. Ejemplo: Queremos bajar un 10%, ponemos -10%."});return e.jsxs(B,{show:t,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(B.Header,{closeButton:!0,children:e.jsx(B.Title,{id:"contained-modal-title-vcenter",children:"Administrar todos los productos"})}),e.jsxs(B.Body,{children:[e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"Cambiar el precio a: "}),e.jsxs("select",{name:"",onChange:C,style:{marginLeft:"5px",border:"none",cursor:"pointer",outline:"none",boxShadow:"none"},children:[e.jsx("option",{value:"guardapolvos",children:"Todos"}),e.jsx("option",{value:"nivel_inicial",children:"Nivel Inicial"}),e.jsx("option",{value:"primaria",children:"Primaria"}),e.jsx("option",{value:"stock",children:"Stock"})]})]}),e.jsxs("div",{className:"d-flex",style:{fontSize:"16px",height:"40px",alignItems:"center"},children:[e.jsx("p",{style:{margin:"0px"},children:"En un: "}),e.jsx("input",{type:"text",onChange:w,style:{width:"40px",outline:"none",boxShadow:"none",border:"1px solid #e2e2e2",marginLeft:"4px"}}),e.jsx("p",{style:{margin:"0px",marginRight:"20px"},children:"%"}),e.jsx(fe,{placement:"right",delay:{show:250,hide:400},overlay:j,children:e.jsx("div",{children:e.jsx("i",{className:"bi bi-info-circle",style:{marginRight:"auto",width:"100%"}})})})]})]}),e.jsxs(B.Footer,{children:[e.jsx(O,{variant:"secondary",onClick:s,children:"Cerrar"}),e.jsx(O,{className:"btn btn-dark",onClick:()=>d(n,m),children:"Aplicar cambios"})]})]})},pt=()=>{const[t,s]=u.useState({all:[],nivelInicial:[],primaria:[],stock:[],accesorios:[]}),[o]=qe(),c=$(S=>S.administration.tabChoosen),r=Q(),[v,b]=u.useState(!1),[n,f]=u.useState(!1),[m,y]=u.useState(!1),[C,w]=u.useState(""),[d,j]=u.useState({});u.useEffect(()=>{(async()=>{if(o&&o.size==0)try{const k=await R.getSearch({all:!0}),N=await R.getSearch({table:"nivel_inicial"}),T=await R.getSearch({table:"primaria"}),p=await R.getSearch({table:"stock"}),P=await R.getSearch({table:"accesorios"});s({all:k,nivelInicial:N,primaria:T,stock:p,accesorios:P})}catch(k){console.error(k.message)}})()},[o]);const h=(S,k)=>{f(!0),w(k),j(S)},i=S=>{w(S),b(!0)},l=()=>{y(!0)},x=S=>{r(Ue(S))},g={width:"100%"};return console.log(t.accesorios),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"contenedor-tablas-productos",children:[e.jsx("div",{className:"d-flex w-100 mb-5",onClick:()=>l(),children:e.jsxs("div",{className:"card",style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-body",children:"Administrar todos los productos"}),e.jsxs("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"small text-black stretched-link",children:"Ver detalles"}),e.jsx("div",{className:"small text-black",children:e.jsx("i",{className:"fas fa-angle-right"})})]})]})}),e.jsx("div",{style:{width:"100%",backgroundColor:"#fff",padding:"10px"},className:"tabs-container",children:e.jsxs(pe,{defaultActiveKey:c,id:"uncontrolled-tab-example",className:"mb-3",fill:!0,onSelect:x,children:[e.jsx(L,{eventKey:"nivel_inicial",title:"Nivel Inicial",style:g,children:e.jsx(z,{title:"NIVEL INICIAL",table:"nivel_inicial",guardapolvosList:t.nivelInicial,showCreateModal:i,showEditModal:h})}),e.jsx(L,{eventKey:"primaria",title:"Primaria",style:g,children:e.jsx(z,{title:"PRIMARIA",table:"primaria",guardapolvosList:t.primaria,showCreateModal:i,showEditModal:h})}),e.jsx(L,{eventKey:"stock",title:"Stock",style:g,children:e.jsx(z,{title:"STOCK",table:"stock",guardapolvosList:t.stock,showCreateModal:i,showEditModal:h})}),e.jsx(L,{eventKey:"accesorios",title:"Accesorios",style:g,children:e.jsx(z,{title:"ACCESORIOS",table:"accesorios",guardapolvosList:t.accesorios,showCreateModal:i,showEditModal:h})})]})}),e.jsx(rt,{item:d,show:n,table:C,onHide:()=>f(!1)}),e.jsx(lt,{show:v,table:C,onHide:()=>b(!1)}),e.jsx(ct,{show:m,onHide:()=>y(!1),guardapolvosList:t})]})})})};export{pt as default};
